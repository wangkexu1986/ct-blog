{"componentChunkName":"component---src-templates-note-js","path":"/notes/重构 改善既有代码的设计 第2版/7","result":{"data":{"dir":{"distinct":["重构 改善既有代码的设计 第2版/第01章 重构，第 一个示例","重构 改善既有代码的设计 第2版/第02章 重构的原则 ","重构 改善既有代码的设计 第2版/第03章 代码的坏味道","重构 改善既有代码的设计 第2版/第04章 构筑测试体系","重构 改善既有代码的设计 第2版/第05章 介绍重构名录","重构 改善既有代码的设计 第2版/第06章 第 一组重构","重构 改善既有代码的设计 第2版/第07章 封装","重构 改善既有代码的设计 第2版/第08章 搬移特性","重构 改善既有代码的设计 第2版/第09章 重新组织数据","重构 改善既有代码的设计 第2版/第10章 简化条件逻辑","重构 改善既有代码的设计 第2版/第11章 重构API","重构 改善既有代码的设计 第2版/第12章 处理继承关系"]},"note":{"edges":[{"node":{"frontmatter":{"title":"","date":"2019-04-24","author":null},"html":"<h2 id=\"提炼函数\" style=\"position:relative;\"><a href=\"#%E6%8F%90%E7%82%BC%E5%87%BD%E6%95%B0\" aria-label=\"提炼函数 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E6%8F%90%E7%82%BC%E5%87%BD%E6%95%B0\" aria-label=\"提炼函数 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>提炼函数</h2>\n<h3 id=\"曾用名--提炼函数（extract-method）\" style=\"position:relative;\"><a href=\"#%E6%9B%BE%E7%94%A8%E5%90%8D--%E6%8F%90%E7%82%BC%E5%87%BD%E6%95%B0%EF%BC%88extract-method%EF%BC%89\" aria-label=\"曾用名  提炼函数（extract method） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E6%9B%BE%E7%94%A8%E5%90%8D--%E6%8F%90%E7%82%BC%E5%87%BD%E6%95%B0%EF%BC%88extract-method%EF%BC%89\" aria-label=\"曾用名  提炼函数（extract method） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>曾用名  提炼函数（Extract Method）</h3>\n<h3 id=\"反向重构-内联函数\" style=\"position:relative;\"><a href=\"#%E5%8F%8D%E5%90%91%E9%87%8D%E6%9E%84-%E5%86%85%E8%81%94%E5%87%BD%E6%95%B0\" aria-label=\"反向重构 内联函数 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8F%8D%E5%90%91%E9%87%8D%E6%9E%84-%E5%86%85%E8%81%94%E5%87%BD%E6%95%B0\" aria-label=\"反向重构 内联函数 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>反向重构 内联函数</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\"> function printOwing(invoice) {\n  printBanner();\n  let outstanding = calculateOutstanding();\n \n  // print details\n  console.log(`name: ${invoice.customer}`);\n  console.log(`amount: ${outstanding}`);\n}</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\"> function printOwing(invoice) {\n  printBanner();\n  let outstanding = calculateOutstanding();\n  printDetails(outstanding);\n  \n  function printDetails(outstanding) {\n     console.log(`name: ${invoice.customer}`);\n     console.log(`amount: ${outstanding}`);\n  }\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA\" aria-label=\"动机 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA\" aria-label=\"动机 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<p>何时应该把代码放进独立的函数？</p>\n<ul>\n<li>观点1： 从代码的长度考虑</li>\n<li>观点2：从代码复用考虑，只要被用过不止一次的代码，就该放进一个函数</li>\n<li>观点3：作者观点，将意图与实现分开</li>\n</ul>\n<blockquote>\n<p>当你需要花时间浏览一段代码才能弄清楚它到底在干什么？那么久应该将其提炼到一个函数中。并命名，通过名字知道它在干什么。\n一个函数一旦超过6行，就开发散发臭味。\n有些人担心短函数会有性能问题，短函数可以更容易的被缓存，不用担心。\n小函数需要好名字，所以应该在命名上花心思。</p>\n</blockquote>\n<h3 id=\"做法\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95\" aria-label=\"做法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95\" aria-label=\"做法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>创造一个新函数，根据这个函数的意图命名（以它做什么来命名，不要以它怎么做命名。）</li>\n<li>讲待提炼的代码从源函数复制到新建的目标函数中</li>\n<li>仔细检查提炼出的代码，看看其中是否引用了作用域限于源函数，在提炼出的新函数中访问不到的变量</li>\n<li>所有变量都处理完后，编译</li>\n<li>在源函数中，将被提炼的代码替换成对目标函数的调用</li>\n<li>测试</li>\n<li>查看其他代码是否有与被提炼的代码段相同或者相似之处。如果有置换成新函数</li>\n</ul>\n<h3 id=\"范例\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B\" aria-label=\"范例 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B\" aria-label=\"范例 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function printOwing(invoice) {\n\tlet outstanding = 0;\n\n\tconsole.log(&quot;***********************&quot;);\n\tconsole.log(&quot;**** Customer Owes ****&quot;);\n\tconsole.log(&quot;***********************&quot;);\n\n\t// calculate outstanding \n\tfor (const o of invoice.orders) {\n\t\toutstanding += o.amount;\n\t}\n\n\t// record due date\n\tconst today = Clock.today; // 避免使用Date.now(), 导致测试行为的不可预测。\n\tinvoice.dueData = new Data(today.getFullYear(), today.getMonth(), today.getDate() + 30);\n\n\t// print details\n\tconsole.log(`name: ${invoice.customer}`);\n\tconsole.log(`amount: ${outstanding}`);\n\tconsole.log(`due: ${invoice.dueData.toLocaleDateString()}`);\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"重构1：-无局部变量（内联函数）\" style=\"position:relative;\"><a href=\"#%E9%87%8D%E6%9E%841%EF%BC%9A-%E6%97%A0%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%EF%BC%88%E5%86%85%E8%81%94%E5%87%BD%E6%95%B0%EF%BC%89\" aria-label=\"重构1： 无局部变量（内联函数） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E9%87%8D%E6%9E%841%EF%BC%9A-%E6%97%A0%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%EF%BC%88%E5%86%85%E8%81%94%E5%87%BD%E6%95%B0%EF%BC%89\" aria-label=\"重构1： 无局部变量（内联函数） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>重构1： 无局部变量（内联函数）</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">    printBanner() {\n\tconsole.log(&quot;***********************&quot;);\n\tconsole.log(&quot;**** Customer Owes ****&quot;);\n\tconsole.log(&quot;***********************&quot;);\n    }\n\n    printDetails() {\n\tconsole.log(`name: ${invoice.customer}`);\n\tconsole.log(`amount: ${outstanding}`);\n\tconsole.log(`due: ${invoice.dueData.toLocaleDateString()}`);\n    }</code>\n        </deckgo-highlight-code>\n<h3 id=\"重构2-有局部变量-新函数\" style=\"position:relative;\"><a href=\"#%E9%87%8D%E6%9E%842-%E6%9C%89%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F-%E6%96%B0%E5%87%BD%E6%95%B0\" aria-label=\"重构2 有局部变量 新函数 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E9%87%8D%E6%9E%842-%E6%9C%89%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F-%E6%96%B0%E5%87%BD%E6%95%B0\" aria-label=\"重构2 有局部变量 新函数 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>重构2: 有局部变量( 新函数)</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function printDetails(invoice, outstanding) {\n\tconsole.log(`name: ${invoice.customer}`);\n\tconsole.log(`amount: ${outstanding}`);\n\tconsole.log(`due: ${invoice.dueData.toLocaleDateString()}`);\n}\n\nfunction recordDueDate(invoice) {\n\tconst today = Clock.today;\n\tinvoice.dueData = new Data(today.getFullYear(), today.getMonth(), today.getDate() + 30);\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"重构3：-对重构变量再赋值\" style=\"position:relative;\"><a href=\"#%E9%87%8D%E6%9E%843%EF%BC%9A-%E5%AF%B9%E9%87%8D%E6%9E%84%E5%8F%98%E9%87%8F%E5%86%8D%E8%B5%8B%E5%80%BC\" aria-label=\"重构3： 对重构变量再赋值 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E9%87%8D%E6%9E%843%EF%BC%9A-%E5%AF%B9%E9%87%8D%E6%9E%84%E5%8F%98%E9%87%8F%E5%86%8D%E8%B5%8B%E5%80%BC\" aria-label=\"重构3： 对重构变量再赋值 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>重构3： 对重构变量再赋值</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function calculateOutstanding(invoice) {\n\tlet result = 0;\n\tfor (const o of invoice.orders) {\n\t\tresult += o.amount;\n\t}\n\treturn result;\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"结果\" style=\"position:relative;\"><a href=\"#%E7%BB%93%E6%9E%9C\" aria-label=\"结果 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E7%BB%93%E6%9E%9C\" aria-label=\"结果 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>结果</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function printOwing(invoice) {\n\tprintBanner();\n\tconst outstanding = calculateOutstanding(invoice);\n\trecordDueDate(invoice);\n\tprintDetails(invoice, outstanding);\n}\n\nfunction printBanner() {\n\tconsole.log(&quot;***********************&quot;);\n\tconsole.log(&quot;**** Customer Owes ****&quot;);\n\tconsole.log(&quot;***********************&quot;);\n}\n\nfunction printDetails(invoice, outstanding) {\n\tconsole.log(`name: ${invoice.customer}`);\n\tconsole.log(`amount: ${outstanding}`);\n\tconsole.log(`due: ${invoice.dueData.toLocaleDateString()}`);\n}\n\nfunction recordDueDate(invoice) {\n\tconst today = Clock.today;\n\tinvoice.dueData = new Data(today.getFullYear(), today.getMonth(), today.getDate() + 30);\n}\n\nfunction calculateOutstanding(invoice) {\n\tlet result = 0;\n\tfor (const o of invoice.orders) {\n\t\tresult += o.amount;\n\t}\n\treturn result;\n}</code>\n        </deckgo-highlight-code>\n<h2 id=\"问题？-怎么判断函数该返回一个值，还是多个值？\" style=\"position:relative;\"><a href=\"#%E9%97%AE%E9%A2%98%EF%BC%9F-%E6%80%8E%E4%B9%88%E5%88%A4%E6%96%AD%E5%87%BD%E6%95%B0%E8%AF%A5%E8%BF%94%E5%9B%9E%E4%B8%80%E4%B8%AA%E5%80%BC%EF%BC%8C%E8%BF%98%E6%98%AF%E5%A4%9A%E4%B8%AA%E5%80%BC%EF%BC%9F\" aria-label=\"问题？ 怎么判断函数该返回一个值，还是多个值？ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E9%97%AE%E9%A2%98%EF%BC%9F-%E6%80%8E%E4%B9%88%E5%88%A4%E6%96%AD%E5%87%BD%E6%95%B0%E8%AF%A5%E8%BF%94%E5%9B%9E%E4%B8%80%E4%B8%AA%E5%80%BC%EF%BC%8C%E8%BF%98%E6%98%AF%E5%A4%9A%E4%B8%AA%E5%80%BC%EF%BC%9F\" aria-label=\"问题？ 怎么判断函数该返回一个值，还是多个值？ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>问题？ 怎么判断函数该返回一个值，还是多个值？</h2>\n<h2 id=\"内联函数\" style=\"position:relative;\"><a href=\"#%E5%86%85%E8%81%94%E5%87%BD%E6%95%B0\" aria-label=\"内联函数 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%86%85%E8%81%94%E5%87%BD%E6%95%B0\" aria-label=\"内联函数 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>内联函数</h2>\n<h3 id=\"曾用名-内联函数（inline-method）\" style=\"position:relative;\"><a href=\"#%E6%9B%BE%E7%94%A8%E5%90%8D-%E5%86%85%E8%81%94%E5%87%BD%E6%95%B0%EF%BC%88inline-method%EF%BC%89\" aria-label=\"曾用名 内联函数（inline method） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E6%9B%BE%E7%94%A8%E5%90%8D-%E5%86%85%E8%81%94%E5%87%BD%E6%95%B0%EF%BC%88inline-method%EF%BC%89\" aria-label=\"曾用名 内联函数（inline method） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>曾用名 内联函数（Inline Method）</h3>\n<h3 id=\"反向重构：-提炼函数\" style=\"position:relative;\"><a href=\"#%E5%8F%8D%E5%90%91%E9%87%8D%E6%9E%84%EF%BC%9A-%E6%8F%90%E7%82%BC%E5%87%BD%E6%95%B0\" aria-label=\"反向重构： 提炼函数 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8F%8D%E5%90%91%E9%87%8D%E6%9E%84%EF%BC%9A-%E6%8F%90%E7%82%BC%E5%87%BD%E6%95%B0\" aria-label=\"反向重构： 提炼函数 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>反向重构： 提炼函数</h3>\n<h3 id=\"例\" style=\"position:relative;\"><a href=\"#%E4%BE%8B\" aria-label=\"例 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E4%BE%8B\" aria-label=\"例 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>例</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function getRating(driver) {\n\treturn moreThanFiveLateDeliveries(driver) ? 2 : 1;\n}\n\nfunction moreThanFiveLateDeliveries(driver) {\n\treturn driver.numberOfLateDeliveries &gt; 5\n}\n\nfunction getRating(driver) {\n\treturn (driver.numberOfLateDeliveries &gt; 5) ? 2 : 1;\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-1\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-1\" aria-label=\"动机 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-1\" aria-label=\"动机 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<ul>\n<li>情况1：</li>\n</ul>\n<p>简短的函数表现动作意图，这样会使代码更清晰易读。但有时候你会遇到某些函数，其内部代码和函数名称同样清晰易读。此时，你应该去掉这个函数。</p>\n<ul>\n<li>情况2：</li>\n</ul>\n<p>讲一群组织不合理的函数，内联到一个大型函数很中，然后再提炼小函数</p>\n<h3 id=\"做法-1\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-1\" aria-label=\"做法 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-1\" aria-label=\"做法 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>检查函数，确定它不具多态性</li>\n</ul>\n<blockquote>\n<p>如果该函数属于一个类，并且有子类继承了这个函数，那么就无法内联</p>\n</blockquote>\n<ul>\n<li>找出这个函数的所有调用点</li>\n<li>将这个函数的所有调用点都替换为函数本体</li>\n<li>每次替换之后，执行测试</li>\n<li>删除该删除的定义</li>\n</ul>\n<h3 id=\"范例-1\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-1\" aria-label=\"范例 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-1\" aria-label=\"范例 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<ul>\n<li>范例1：</li>\n</ul>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">// 重构前\nfunction getRating(driver) {\n\treturn moreThanFiveLateDeliveries(driver) ? 2 : 1;\n}\n\nfunction moreThanFiveLateDeliveries(driver) {\n\treturn driver.numberOfLateDeliveries &gt; 5\n}\n\n// 重构后\nfunction getRating(driver) {\n\treturn (driver.numberOfLateDeliveries &gt; 5) ? 2 : 1;\n}</code>\n        </deckgo-highlight-code>\n<p>直接代码替换</p>\n<ul>\n<li>范例2：</li>\n</ul>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">// 重构前\nfunction getRating(driver) {\n\treturn moreThanFiveLateDeliveries(driver) ? 2 : 1;\n}\n\nfunction moreThanFiveLateDeliveries(dvr) {\n\treturn dvr.numberOfLateDeliveries &gt; 5\n}\n\n// 重构后\nfunction getRating(aDriver) {\n\treturn (aDriver.numberOfLateDeliveries &gt; 5) ? 2 : 1;\n}</code>\n        </deckgo-highlight-code>\n<p>需要修改变量名</p>\n<h2 id=\"提炼变量（extract-variable）\" style=\"position:relative;\"><a href=\"#%E6%8F%90%E7%82%BC%E5%8F%98%E9%87%8F%EF%BC%88extract-variable%EF%BC%89\" aria-label=\"提炼变量（extract variable） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E6%8F%90%E7%82%BC%E5%8F%98%E9%87%8F%EF%BC%88extract-variable%EF%BC%89\" aria-label=\"提炼变量（extract variable） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>提炼变量（Extract Variable）</h2>\n<h3 id=\"曾用名-引入解释性变量（introduce-explaining-variable）\" style=\"position:relative;\"><a href=\"#%E6%9B%BE%E7%94%A8%E5%90%8D-%E5%BC%95%E5%85%A5%E8%A7%A3%E9%87%8A%E6%80%A7%E5%8F%98%E9%87%8F%EF%BC%88introduce-explaining-variable%EF%BC%89\" aria-label=\"曾用名 引入解释性变量（introduce explaining variable） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E6%9B%BE%E7%94%A8%E5%90%8D-%E5%BC%95%E5%85%A5%E8%A7%A3%E9%87%8A%E6%80%A7%E5%8F%98%E9%87%8F%EF%BC%88introduce-explaining-variable%EF%BC%89\" aria-label=\"曾用名 引入解释性变量（introduce explaining variable） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>曾用名: 引入解释性变量（Introduce Explaining Variable）</h3>\n<h3 id=\"反向重构：内联变量\" style=\"position:relative;\"><a href=\"#%E5%8F%8D%E5%90%91%E9%87%8D%E6%9E%84%EF%BC%9A%E5%86%85%E8%81%94%E5%8F%98%E9%87%8F\" aria-label=\"反向重构：内联变量 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8F%8D%E5%90%91%E9%87%8D%E6%9E%84%EF%BC%9A%E5%86%85%E8%81%94%E5%8F%98%E9%87%8F\" aria-label=\"反向重构：内联变量 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>反向重构：内联变量</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">return order.quantity * order.itemPrice - \nMath.max(0, order.quantity - 500) * order.itemPrice * 0.05 +\nMath.min(order.quantity * order.itemPrice * 0.1, 100);\n\n\nconst basePrice = order.quantity * order.itemPrice;\nconst quantityDiscount = Math.max(0, order.quantity - 500) * order.itemPrice * 0.05;\nconst shipping = Math.min(basePrice * 0.1, 100);\nreturn basePrice - quantityDiscount + shipping;\n</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-2\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-2\" aria-label=\"动机 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-2\" aria-label=\"动机 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<p>表达式复杂且难懂的情况下，可以提取局部变量帮助我们理解代码，这样也便于调试</p>\n<h3 id=\"做法-2\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-2\" aria-label=\"做法 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-2\" aria-label=\"做法 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>确认要提炼的表达式没有副作用</li>\n<li>声明一个不可修改的变量，把你想要提炼的表达式复制一份，以该表达式的结果值给这个变量赋值。</li>\n<li>用这个新变量取代原来的表达式</li>\n<li>测试</li>\n</ul>\n<h3 id=\"范例-2\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-2\" aria-label=\"范例 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-2\" aria-label=\"范例 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">// 重构前\nclass Order {\n\tconstructor(aRecord) {\n\t\tthis._data = aRecord;\n\t}\n\n\tget quantity() { return this._data.quantity; }\n\tget itemPrice() { return this._data.itemPrice; }\n\tget price() {\n\t\treturn order.quantity * order.itemPrice - \n\t\t\tMath.max(0, order.quantity - 500) * order.itemPrice * 0.05 +\n\t\t\tMath.min(order.quantity * order.itemPrice * 0.1, 100);\n\t}\n\n}\n\n// 重构后\nclass Order {\n\tconstructor(aRecord) {\n\t\tthis._data = aRecord;\n\t}\n\n\tget quantity() { return this._data.quantity; }\n\tget itemPrice() { return this._data.itemPrice; }\n\tget price() {\n\t\treturn this.basePrice - this.quantityDiscount + this.shipping;\n\t}\n\tget basePrice() { return this.quantity * this.itemPrice; }\n\tget quantityDiscount { return Math.max(0, this.quantity - 500) * this.itemPrice * 0.05; }\n\tget shipping() { return Math.min(this.basePrice * 0.1, 100);}\n}</code>\n        </deckgo-highlight-code>\n<h2 id=\"内联变量（inline-variable）\" style=\"position:relative;\"><a href=\"#%E5%86%85%E8%81%94%E5%8F%98%E9%87%8F%EF%BC%88inline-variable%EF%BC%89\" aria-label=\"内联变量（inline variable） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%86%85%E8%81%94%E5%8F%98%E9%87%8F%EF%BC%88inline-variable%EF%BC%89\" aria-label=\"内联变量（inline variable） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>内联变量（Inline Variable）</h2>\n<h3 id=\"曾用名-内联临时变量（inline-temp）\" style=\"position:relative;\"><a href=\"#%E6%9B%BE%E7%94%A8%E5%90%8D-%E5%86%85%E8%81%94%E4%B8%B4%E6%97%B6%E5%8F%98%E9%87%8F%EF%BC%88inline-temp%EF%BC%89\" aria-label=\"曾用名 内联临时变量（inline temp） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E6%9B%BE%E7%94%A8%E5%90%8D-%E5%86%85%E8%81%94%E4%B8%B4%E6%97%B6%E5%8F%98%E9%87%8F%EF%BC%88inline-temp%EF%BC%89\" aria-label=\"曾用名 内联临时变量（inline temp） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>曾用名: 内联临时变量（Inline Temp）</h3>\n<h3 id=\"反向重构：-提炼变量\" style=\"position:relative;\"><a href=\"#%E5%8F%8D%E5%90%91%E9%87%8D%E6%9E%84%EF%BC%9A-%E6%8F%90%E7%82%BC%E5%8F%98%E9%87%8F\" aria-label=\"反向重构： 提炼变量 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8F%8D%E5%90%91%E9%87%8D%E6%9E%84%EF%BC%9A-%E6%8F%90%E7%82%BC%E5%8F%98%E9%87%8F\" aria-label=\"反向重构： 提炼变量 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>反向重构： 提炼变量</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">let basePrice = anOrder.basePrice;\nreturn (basePrice &gt; 1000);\n\nreturn anOrder.basePrice &gt; 1000</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-3\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-3\" aria-label=\"动机 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-3\" aria-label=\"动机 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<p>在一个函数内部，变量能给表达式提供有意义的名字，因此通常变量是好东西。但有时候，名字并不比表达式本身具有表现力</p>\n<h3 id=\"做法-3\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-3\" aria-label=\"做法 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-3\" aria-label=\"做法 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>检查确认变量赋值语句的右侧表达式没有副作用</li>\n<li>如果变量没有被声明为不可修改，先将其变为不可修改，并执行测试</li>\n<li>找到第一处使用该变量的地方，将其替换为直接使用赋值语句的右侧表达式</li>\n<li>测试</li>\n<li>重复前面两步，逐一替换其他素有使用该变量的地方。</li>\n<li>删除该变量的声明点和赋值语句</li>\n<li>测试</li>\n</ul>\n<h2 id=\"改变函数声明（change-function-declaration）\" style=\"position:relative;\"><a href=\"#%E6%94%B9%E5%8F%98%E5%87%BD%E6%95%B0%E5%A3%B0%E6%98%8E%EF%BC%88change-function-declaration%EF%BC%89\" aria-label=\"改变函数声明（change function declaration） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E6%94%B9%E5%8F%98%E5%87%BD%E6%95%B0%E5%A3%B0%E6%98%8E%EF%BC%88change-function-declaration%EF%BC%89\" aria-label=\"改变函数声明（change function declaration） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>改变函数声明（Change Function Declaration）</h2>\n<h3 id=\"曾用名：函数改名（rename-method）\" style=\"position:relative;\"><a href=\"#%E6%9B%BE%E7%94%A8%E5%90%8D%EF%BC%9A%E5%87%BD%E6%95%B0%E6%94%B9%E5%90%8D%EF%BC%88rename-method%EF%BC%89\" aria-label=\"曾用名：函数改名（rename method） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E6%9B%BE%E7%94%A8%E5%90%8D%EF%BC%9A%E5%87%BD%E6%95%B0%E6%94%B9%E5%90%8D%EF%BC%88rename-method%EF%BC%89\" aria-label=\"曾用名：函数改名（rename method） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>曾用名：函数改名（Rename Method）</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function circum(radius) { ... }\n\nfunction circumference(radius) {  ... }</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-4\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-4\" aria-label=\"动机 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-4\" aria-label=\"动机 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<ul>\n<li>很难一次就给函数起个好名，即使名字有点疑惑也先放着。一旦想到好名字，马上替换。</li>\n<li>函数参数的变化，能增加函数的作用范围</li>\n</ul>\n<h3 id=\"做法-4\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-4\" aria-label=\"做法 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-4\" aria-label=\"做法 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ol>\n<li>简单做法</li>\n</ol>\n<ul>\n<li>如果想要移除一个参数，需要先确定函数体内没有使用该参数。</li>\n<li>修改函数声明，使其成为你期望的状态。</li>\n<li>找出所有使用旧的函数声明的地方，将它们改为使用新的函数声明</li>\n<li>测试</li>\n</ul>\n<ol start=\"2\">\n<li>迁移式做法</li>\n</ol>\n<ul>\n<li>如果有必要的话，先对函数体内部加以重构，使后面的提炼步骤易于开展。</li>\n<li>使用提炼函数将函数体提炼成一个新函数</li>\n<li>如果提炼出的函数需要新增参数，用前面的简单做法添加即可</li>\n<li>测试</li>\n<li>对就函数使用内联函数</li>\n<li>如果新函数使用了临时的名字，再次使用改变函数声明将其改回原来的名字。</li>\n<li>测试</li>\n</ul>\n<h3 id=\"范例-函数改名（简单做法）\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-%E5%87%BD%E6%95%B0%E6%94%B9%E5%90%8D%EF%BC%88%E7%AE%80%E5%8D%95%E5%81%9A%E6%B3%95%EF%BC%89\" aria-label=\"范例 函数改名（简单做法） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-%E5%87%BD%E6%95%B0%E6%94%B9%E5%90%8D%EF%BC%88%E7%AE%80%E5%8D%95%E5%81%9A%E6%B3%95%EF%BC%89\" aria-label=\"范例 函数改名（简单做法） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例 函数改名（简单做法）</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function circum(radius) { \n  return 2 * Math.PI * radius;\n}\n\nfunction circumference(radius) { \n  return 2 * Math.PI * radius;\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"范例-函数改名（迁移式做法）\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-%E5%87%BD%E6%95%B0%E6%94%B9%E5%90%8D%EF%BC%88%E8%BF%81%E7%A7%BB%E5%BC%8F%E5%81%9A%E6%B3%95%EF%BC%89\" aria-label=\"范例 函数改名（迁移式做法） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-%E5%87%BD%E6%95%B0%E6%94%B9%E5%90%8D%EF%BC%88%E8%BF%81%E7%A7%BB%E5%BC%8F%E5%81%9A%E6%B3%95%EF%BC%89\" aria-label=\"范例 函数改名（迁移式做法） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例 函数改名（迁移式做法）</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function circum(radius) { \n  return circumference(radius);\n}\n\nfunction circumference(radius) { \n  return 2 * Math.PI * radius;\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"范例-添加参数\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-%E6%B7%BB%E5%8A%A0%E5%8F%82%E6%95%B0\" aria-label=\"范例 添加参数 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-%E6%B7%BB%E5%8A%A0%E5%8F%82%E6%95%B0\" aria-label=\"范例 添加参数 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例 添加参数</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">// 图书管理系统，接受图书的预订\naddReservation(customer) {\n\tthis._reservations.push(customer);\n}\n\n// 需求，支持高优先级预订\n\n//  1. 先给函数一个临时的变量名\naddReservation(customer) {\n\tthis.zz_addReservation(customer);\n}\n\nzz_addReservation(customer) {\n\tthis._reservations.push(customer);\n}\n\n// 2. 给新函数增加参数\naddReservation(customer) {\n\tthis.zz_addReservation(customer, false);\n}\n\nzz_addReservation(customer, isPriority) {\n\tthis._reservations.push(customer);\n}\n\n// 3. 引入断言？\naddReservation(customer) {\n\tthis.zz_addReservation(customer, false);\n}\n\nzz_addReservation(customer, isPriority) {\n        assert（isPriority === true|| isPriority === false);\n\tthis._reservations.push(customer);\n}\n\n// 4. 改回新函数的名字</code>\n        </deckgo-highlight-code>\n<h3 id=\"范例-把参数改为属性\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-%E6%8A%8A%E5%8F%82%E6%95%B0%E6%94%B9%E4%B8%BA%E5%B1%9E%E6%80%A7\" aria-label=\"范例 把参数改为属性 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-%E6%8A%8A%E5%8F%82%E6%95%B0%E6%94%B9%E4%B8%BA%E5%B1%9E%E6%80%A7\" aria-label=\"范例 把参数改为属性 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例 把参数改为属性</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">// 判断一个顾客是不是来自新英格兰\nfunction inNewEngland(aCustomer) {\n\treturn [&quot;MA&quot;, &quot;CT&quot;, &quot;ME&quot;, &quot;VT&quot;, &quot;NH&quot;, &quot;RI&quot;].includes(aCustomer.address.state);\n}\n\n// 调用\nconst newEnglanders = someCustomers.filter(c =&gt; inNewEngland(c));\n</code>\n        </deckgo-highlight-code>\n<p>练习重构？？</p>\n<details>\n  <summary>重构结果</summary>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">// 判断一个顾客是不是来自新英格兰\nfunction inNewEngland(stateCode) {\n\treturn [&quot;MA&quot;, &quot;CT&quot;, &quot;ME&quot;, &quot;VT&quot;, &quot;NH&quot;, &quot;RI&quot;].includes(stateCode);\n}\n\n// 调用\nconst newEnglanders = someCustomers.filter(c =&gt; inNewEngland(c.address.state));\n</code>\n        </deckgo-highlight-code>\n</details>\n<h2 id=\"封装变量（encapsulate-variable）\" style=\"position:relative;\"><a href=\"#%E5%B0%81%E8%A3%85%E5%8F%98%E9%87%8F%EF%BC%88encapsulate-variable%EF%BC%89\" aria-label=\"封装变量（encapsulate variable） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%B0%81%E8%A3%85%E5%8F%98%E9%87%8F%EF%BC%88encapsulate-variable%EF%BC%89\" aria-label=\"封装变量（encapsulate variable） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>封装变量（Encapsulate Variable）</h2>\n<h3 id=\"曾用名-自封装字段（self-encapsulate-field）\" style=\"position:relative;\"><a href=\"#%E6%9B%BE%E7%94%A8%E5%90%8D-%E8%87%AA%E5%B0%81%E8%A3%85%E5%AD%97%E6%AE%B5%EF%BC%88self-encapsulate-field%EF%BC%89\" aria-label=\"曾用名 自封装字段（self encapsulate field） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E6%9B%BE%E7%94%A8%E5%90%8D-%E8%87%AA%E5%B0%81%E8%A3%85%E5%AD%97%E6%AE%B5%EF%BC%88self-encapsulate-field%EF%BC%89\" aria-label=\"曾用名 自封装字段（self encapsulate field） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>曾用名: 自封装字段（Self-Encapsulate Field）</h3>\n<h3 id=\"曾用名-封装字段（encapsulate-field）\" style=\"position:relative;\"><a href=\"#%E6%9B%BE%E7%94%A8%E5%90%8D-%E5%B0%81%E8%A3%85%E5%AD%97%E6%AE%B5%EF%BC%88encapsulate-field%EF%BC%89\" aria-label=\"曾用名 封装字段（encapsulate field） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E6%9B%BE%E7%94%A8%E5%90%8D-%E5%B0%81%E8%A3%85%E5%AD%97%E6%AE%B5%EF%BC%88encapsulate-field%EF%BC%89\" aria-label=\"曾用名 封装字段（encapsulate field） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>曾用名: 封装字段（Encapsulate Field）</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">let defaultOwner = { firstName: &quot;Martin&quot;, lastName: &quot;Fowler&quot;};\n\nlet defaultOwnerData = { firstName: &quot;Martin&quot;, lastName: &quot;Fowler&quot;};\nexport function defaultOwner() { return defaultOwnerData; }\nexport function setDefaultOwner(arg) { defaultOwnerData = arg; }</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-5\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-5\" aria-label=\"动机 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-5\" aria-label=\"动机 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<p>想要迁移一处被广泛使用的数据，最好的办法往往是先以函数形式封装所有对该数据的访问。\n封装数据，还能监控数据的变化和使用情况。</p>\n<h3 id=\"做法-5\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-5\" aria-label=\"做法 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-5\" aria-label=\"做法 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>创建封装函数，在其中访问和更新变量值</li>\n<li>执行静态检查</li>\n<li>逐一修改使用该变量的代码，将其改为调用合适的封装函数。每次替换之后，执行测试。</li>\n<li>限制变量的可见性</li>\n<li>测试</li>\n<li>如果变量值是一个记录，考虑使用封装记录手法</li>\n</ul>\n<h3 id=\"范例-3\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-3\" aria-label=\"范例 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-3\" aria-label=\"范例 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">// 定义\nlet defaultOwner = { firstName: &quot;Martin&quot;, lastName: &quot;Fowler&quot;};\n\n// 调用\nspaceship.owner = defaultOwner;\n\n// 更新\ndefaultOwner = { firstName: &quot;Rebecca&quot;, lastName: &quot;Parsons&quot;};\n\n\n// 重构\nlet defaultOwnerData = { firstName: &quot;Martin&quot;, lastName: &quot;Fowler&quot;};\nexport function defaultOwner() { return defaultOwnerData; }\nexport function setDefaultOwner(arg) { defaultOwnerData = arg; }\n\nspaceship.owner = defaultOwner();\nsetDefaultOwner({ firstName: &quot;Rebecca&quot;, lastName: &quot;Parsons&quot;});</code>\n        </deckgo-highlight-code>\n<h3 id=\"封装值\" style=\"position:relative;\"><a href=\"#%E5%B0%81%E8%A3%85%E5%80%BC\" aria-label=\"封装值 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%B0%81%E8%A3%85%E5%80%BC\" aria-label=\"封装值 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>封装值</h3>\n<p>前面的手法只封装了对最外层数据的引用。如果想控制对内容的修改。有两个办法。</p>\n<ol>\n<li>禁止对数据结构内部的数值做任何修改，</li>\n</ol>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">let defaultOwnerData = { firstName: &quot;Martin&quot;, lastName: &quot;Fowler&quot;};\nexport function defaultOwner() { return Object.assign({}, defaultOwnerData); }\nexport function setDefaultOwner(arg) { defaultOwnerData = arg; }</code>\n        </deckgo-highlight-code>\n<ol start=\"2\">\n<li>封装记录阻止对数据的修改</li>\n</ol>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">let defaultOwnerData = { firstName: &quot;Martin&quot;, lastName: &quot;Fowler&quot;};\nexport function defaultOwner() { return new Person(defaultOwnerData); }\nexport function setDefaultOwner(arg) { defaultOwnerData = arg; }\n\n\nclass Person {\n  constructor(data) {\n     this._lastName = data.lastName;\n     this._firstName = data.firstName;\n  }\n\n  get lastName() { return this._lastName;}\n  get firstName() { return this._firstName;}\n}</code>\n        </deckgo-highlight-code>\n<h2 id=\"变量改名-rename-variable\" style=\"position:relative;\"><a href=\"#%E5%8F%98%E9%87%8F%E6%94%B9%E5%90%8D-rename-variable\" aria-label=\"变量改名 rename variable permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8F%98%E9%87%8F%E6%94%B9%E5%90%8D-rename-variable\" aria-label=\"变量改名 rename variable permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>变量改名 (Rename Variable)</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">  let a = height * width;\n  \n  let area = height * width;</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-6\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-6\" aria-label=\"动机 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-6\" aria-label=\"动机 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<p>好的命名是整洁编程的核心，使用范围越广，名字的好坏就越重要</p>\n<h3 id=\"做法-6\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-6\" aria-label=\"做法 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-6\" aria-label=\"做法 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>如果变量被广泛使用，考虑运用封装变量将其封装起来。</li>\n<li>找出所有使用该变量的代码，逐一修改。</li>\n<li>测试</li>\n</ul>\n<h3 id=\"范例-4\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-4\" aria-label=\"范例 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-4\" aria-label=\"范例 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">  let tpHd = &quot;untitled&quot;;\n  result += `&lt;h1&gt;${tpHd}&lt;/h1&gt;`;\n\n //\n tpHd = obj[&#39;articleTitle&#39;]\n\n\n\n// 重构\nresult += `&lt;h1&gt;${title()}&lt;/h1&gt;`\nsetTitle(obj[&#39;articleTitle&#39;]);\n\nfunction title() { return tpHd; }\nfunction setTitle(arg) { return arg; }\n</code>\n        </deckgo-highlight-code>\n<h3 id=\"给常量改名\" style=\"position:relative;\"><a href=\"#%E7%BB%99%E5%B8%B8%E9%87%8F%E6%94%B9%E5%90%8D\" aria-label=\"给常量改名 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E7%BB%99%E5%B8%B8%E9%87%8F%E6%94%B9%E5%90%8D\" aria-label=\"给常量改名 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>给常量改名</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\"> const cpyNm = &quot;Acme Gooseberries&quot;;\n\n\nconst companyName = &quot;Acme Gooseberries&quot;;\nconst cpyNm = companyName;</code>\n        </deckgo-highlight-code>\n<h2 id=\"引入参数对象introduce-parameter-object\" style=\"position:relative;\"><a href=\"#%E5%BC%95%E5%85%A5%E5%8F%82%E6%95%B0%E5%AF%B9%E8%B1%A1introduce-parameter-object\" aria-label=\"引入参数对象introduce parameter object permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%BC%95%E5%85%A5%E5%8F%82%E6%95%B0%E5%AF%B9%E8%B1%A1introduce-parameter-object\" aria-label=\"引入参数对象introduce parameter object permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>引入参数对象(Introduce Parameter Object)</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function amountInvoiced(startDate, endDate) {...}\nfunction amountReceived(startDate, endDate) {...}\nfunction amountOverdue(startDate, endDate) {...}\n\n\nfunction amountInvoiced(aDateRange) {...}\nfunction amountReceived(aDateRange) {...}\nfunction amountOverdue(aDateRange) {...}\n</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-7\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-7\" aria-label=\"动机 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-7\" aria-label=\"动机 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<p>讲数据组织成结构是一件有价值的事，可以让数据项之间的关系变得明晰。</p>\n<h3 id=\"做法-7\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-7\" aria-label=\"做法 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-7\" aria-label=\"做法 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>如果暂时还没有一个合适的数据结构，就创建一个。</li>\n<li>测试</li>\n<li>使用改变函数声明给原来的函数新增一个参数，类型是新建的数据结构</li>\n<li>测试</li>\n<li>调整所有调用者，传入新数据结构的适当实例。没修改一处，执行测试。</li>\n<li>用新数据结构中的每项元素，逐一取代单数列表中与之对应的参数项，然后删除原来的参数。测试。</li>\n</ul>\n<h3 id=\"范例-5\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-5\" aria-label=\"范例 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-5\" aria-label=\"范例 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">// 检查一组温度数据，是否超出了指定的温度范围。\nconst station = {\n\tname: &quot;ZB1&quot;,\n\treadings: [\n\t\t{ temp: 47, time: &quot;2016-11-10 09:10&quot; },\n\t\t{ temp: 53, time: &quot;2016-11-10 09:20&quot; },\n\t\t{ temp: 58, time: &quot;2016-11-10 09:30&quot; },\n\t\t{ temp: 53, time: &quot;2016-11-10 09:40&quot; },\n\t\t{ temp: 51, time: &quot;2016-11-10 09:50&quot; }\n\t]\n};\n\nfunction readingOutsideRange(station, min, max) {\n\treturn station.readings.filter(r =&gt; r.temp &lt; min || r.temp &gt; max);\n}\n\n\n// 调用\nalerts = readingOutsideRange(station, operationPlan.temperatureFlor, operationPlan.temperatureCeling);\n\n// 重构\n// 1.  抽象min， max\nclass NumberRange {\n\tconstructor(min, max) {\n\t\tthis._data = {min, max};\n\t}\n\n\tget min() { return this._data.min; }\n\tget max() { return this._data.max; }\n}\n\n\n// 2. 给函数添加新参数\nfunction readingOutsideRange(station, min, max, range) {\n\treturn station.readings.filter(r =&gt; r.temp &lt; min || r.temp &gt; max);\n}\n\n// 3. 修改调用\nalerts = readingOutsideRange(station, operationPlan.temperatureFlor, operationPlan.temperatureCeling, null);\n\n\n// 4. 替换\nconst range = new NumberRange(operationPlan.temperatureFlor, operationPlan.temperatureCeling);\nalerts = readingOutsideRange(station, operationPlan.temperatureFlor, operationPlan.temperatureCeling, range);\n\n\n// 5. 修改参数 从max开始\nfunction readingOutsideRange(station, min, range) {\n\treturn station.readings.filter(r =&gt; r.temp &lt; min || r.temp &gt; range.max);\n}\n\nalerts = readingOutsideRange(station, operationPlan.temperatureFlor, range);\n\n// 6. 修改min\nfunction readingOutsideRange(station, range) {\n\treturn station.readings.filter(r =&gt; r.temp &lt; range.min || r.temp &gt; range.max);\n}\n\nalerts = readingOutsideRange(station, range);\n\n// 7. 提炼范围函数\nclass NumberRange {\n\tconstructor(min, max) {\n\t\tthis._data = {min, max};\n\t}\n\n\tget min() { return this._data.min; }\n\tget max() { return this._data.max; }\n\tcontains(arg) {\n\t\treturn (arg &gt;= this.min &amp;&amp; arg &lt;= this.max);\n\t}\n}\n\nfunction readingOutsideRange(station, range) {\n\treturn station.readings.filter(r =&gt; range.contains(r.temp);\n}</code>\n        </deckgo-highlight-code>\n<h2 id=\"函数组合成类combine-functions-into-class\" style=\"position:relative;\"><a href=\"#%E5%87%BD%E6%95%B0%E7%BB%84%E5%90%88%E6%88%90%E7%B1%BBcombine-functions-into-class\" aria-label=\"函数组合成类combine functions into class permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%87%BD%E6%95%B0%E7%BB%84%E5%90%88%E6%88%90%E7%B1%BBcombine-functions-into-class\" aria-label=\"函数组合成类combine functions into class permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>函数组合成类(Combine Functions into Class)</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function base() {...}\nfunction taxableCharge() {...}\nfunction calculateBaseCharge() {...}\n\nclass Reading {\n\tbase() {...}\n\ttaxableCharge() {...}\n\tcalculateBaseCharge() {...}\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-8\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-8\" aria-label=\"动机 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-8\" aria-label=\"动机 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<p>如果发现一组函数形影不离的操作同一块数据，就认为是时候组件一个类了。类能明确的给这些函数提供一个共用的环境，在对象内部调用这些函数，可以减少传递的参数，从而简化函数调用。</p>\n<h3 id=\"做法-8\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-8\" aria-label=\"做法 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-8\" aria-label=\"做法 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>运用封装记录对过个函数共用的数据记录加以封装。</li>\n<li>对于使用该记录结构的每个函数，运用搬移函数将其移入新类。</li>\n<li>用以处理该数据记录的逻辑可以用提炼函数提炼出来，并移入新类。</li>\n</ul>\n<h3 id=\"范例-6\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-6\" aria-label=\"范例 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-6\" aria-label=\"范例 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">// 虚构一种用于向老百姓供给茶水的公共设施。每个月会有软件读取茶水计量器的数据。\nreading = { customer: &quot;ivan&quot;, quantity: 10, month: 5, year: 2017 };\n\n// 客户端1：\nconst aReading = acquireReading();\n// 基础费用\nconst baseCharge = baseRate(aReading.month, aReading.year) * aReading.quantity\n\n// 客户端2：\n// 超出一定的量，需要缴税\nconst aReading = acquireReading();\nconst base = baseRate(aReading.month, aReading.year) * aReading.quantity;\nconst taxableCharge = Math.max(0, base - taxThreshold(aReading.year));\n\n\n// 客户端3：\n// 超出一定的量，需要缴税\nconst aReading = acquireReading();\nconst basicChargeAmount = calculateBaseCharge(aReading);\n\nfunction calculateBaseCharge(aReading) {\n  return baseRate(aReading.month, aReading.year) * aReading.quantity;\n}\n\n\n// 封装记录\nclass Reading {\n   \n   constructor(data) {\n   \t  this._customer = data.customer;\n   \t  this._quantity =data.quantity;\n   \t  this._month = data.month;\n   \t  this._year = data.year;\n   }\n\n   get customer() { return this._customer; }\n   get quantity() { return this._quantity; }\n   get month() { return this._month; }\n   get year() { return this._year; }\n}\n\n// 客户端3\nconst rawReading = acquireReading();\nconst aReading = new Reading(rawReading);\nconst basicChargeAmount = calculateBaseCharge(aReading);</code>\n        </deckgo-highlight-code>\n<p>搬移函数</p>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">class Reading {\n   \n   constructor(data) {\n   \t  this._customer = data.customer;\n   \t  this._quantity =data.quantity;\n   \t  this._month = data.month;\n   \t  this._year = data.year;\n   }\n\n   get customer() { return this._customer; }\n   get quantity() { return this._quantity; }\n   get month() { return this._month; }\n   get year() { return this._year; }\n   get baseCharge() {\n   \t  return baseRate(this.month, this.year) * this.quantity;\n   }\n}\n\n// 客户端1\nconst rawReading = acquireReading();\nconst aReading = new Reading(rawReading);\nconst baseCharge = aReading.baseCharge;\n\n// 客户端2\nconst rawReading = acquireReading();\nconst aReading = new Reading(rawReading);\nconst taxableCharge = Math.max(0, aReading.baseCharge - taxThreshold(aReading.year));\n\n// 客户端3\nconst rawReading = acquireReading();\nconst aReading = new Reading(rawReading);\nconst basicChargeAmount = aReading.baseCharge;</code>\n        </deckgo-highlight-code>\n<p>// TODO  思考？</p>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">class Reading {\n   \n   constructor(data) {\n   \t  this._customer = data.customer;\n   \t  this._quantity =data.quantity;\n   \t  this._month = data.month;\n   \t  this._year = data.year;\n   }\n\n   get customer() { return this._customer; }\n   get quantity() { return this._quantity; }\n   get month() { return this._month; }\n   get year() { return this._year; }\n   get baseCharge() {\n   \t  return baseRate(this.month, this.year) * this.quantity;\n   }\n   get taxableCharge() {\n   \t  return Math.max(0, this.baseCharge - taxThreshold(this.year));\n   }\n}</code>\n        </deckgo-highlight-code>\n<h2 id=\"函数组合成变换（combine-functions-into-transform）\" style=\"position:relative;\"><a href=\"#%E5%87%BD%E6%95%B0%E7%BB%84%E5%90%88%E6%88%90%E5%8F%98%E6%8D%A2%EF%BC%88combine-functions-into-transform%EF%BC%89\" aria-label=\"函数组合成变换（combine functions into transform） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%87%BD%E6%95%B0%E7%BB%84%E5%90%88%E6%88%90%E5%8F%98%E6%8D%A2%EF%BC%88combine-functions-into-transform%EF%BC%89\" aria-label=\"函数组合成变换（combine functions into transform） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>函数组合成变换（Combine Functions into Transform）</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function base(aReading) { ... }\nfunction taxableCharge(aReading) { ... }\n\nfunction enrichReading(argReading) {\n\tconst aReading = _.cloneDeep(argReading);\n\taReading.baseCharge = base(aReading);\n\taReading.taxableCharge = taxableCharge(aReading);\n\treturn aReading\n}\n</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-9\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-9\" aria-label=\"动机 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-9\" aria-label=\"动机 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<p>计算派生数据的逻辑收拢到移除，便于更新逻辑，避免重复。</p>\n<h3 id=\"做法-9\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-9\" aria-label=\"做法 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-9\" aria-label=\"做法 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>创建一个变换函数，输入参数是需要变换的记录，并直接返回该记录的值。</li>\n<li>挑选一块逻辑，将其主题移入变换函数中，把结果作为字段添加到输出记录中。修改客户端代码，令其使用这个新字段</li>\n<li>测试</li>\n<li>针对其他相关的计算逻辑，重复上述步骤</li>\n</ul>\n<h3 id=\"范例-7\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-7\" aria-label=\"范例 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-7\" aria-label=\"范例 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function enrichReading(original) {\n\tconst result = _.cloneDeep(original);\n\tresult.baseCharge = base(original);\n\tresult.taxableCharge = taxableCharge(original);\n\treturn result\n}</code>\n        </deckgo-highlight-code>\n<p>如果代码中会对源数据做更新，那么使用类要好很多；如果使用变换，派生数据会被存储在新做成的记录中，一旦源数据被修改，可能会有数据不一致。\n两种手法，根据已有的编程风格来选择。</p>\n<h2 id=\"拆分阶段（split-phase）\" style=\"position:relative;\"><a href=\"#%E6%8B%86%E5%88%86%E9%98%B6%E6%AE%B5%EF%BC%88split-phase%EF%BC%89\" aria-label=\"拆分阶段（split phase） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E6%8B%86%E5%88%86%E9%98%B6%E6%AE%B5%EF%BC%88split-phase%EF%BC%89\" aria-label=\"拆分阶段（split phase） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>拆分阶段（Split Phase）</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">\nconst orderData = orderString.split(/\\s+/);\nconst productPrice = priceList[orderData[0]].split(&quot;-&quot;)[1]];\nconst orderPrice = parseInt(orderData[1]) * productPrice;\n\n\n// 重构后\nconst orderRecord = parseOrder(order);\nconst orderPrice = price(orderRecord, priceList);\n\nfunction parseOrder(aString) {\n\tconst values = aString.split(/\\s+/);\n\treturn ({\n\t\tproductID: values[0].split(“-”)[1],\n\t\tquantity: parseInt(values[1]),\n\t});\n}\n\n\nfunction price(order, priceList) {\n\treturn order.quantity * priceList[order.productID];\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-10\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-10\" aria-label=\"动机 10 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-10\" aria-label=\"动机 10 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<p>同一段代码，在处理两件不同的事时，拆分成各自独立的模块。</p>\n<h3 id=\"做法-10\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-10\" aria-label=\"做法 10 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-10\" aria-label=\"做法 10 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>将第二阶段的代码提炼成独立的函数</li>\n<li>测试</li>\n<li>引入一个中转数据结构，将其作为参数添加到提炼出的新函数的参数列表中。</li>\n<li>测试</li>\n<li>逐一检查提炼出的“第二阶段函数”的每个参数。如果某个参数被第一阶段用到，就将其移入中转数据结构。每次搬移之后都要执行测试。</li>\n<li>对第一阶段的代码运用提炼函数，让提炼出的函数返回中转数据结构。</li>\n</ul>\n<h3 id=\"范例-8\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-8\" aria-label=\"范例 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-8\" aria-label=\"范例 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"dracula\" line-numbers=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">// 计算单价\nfunction priceOrder(product, quantity, shippingMethod) {\n\tconst basePrice = product.basePrice * quantity;\n\tconst discount = Math.max(quantity - product.discountThreshold, 0) * product.basePrice * product.discountRate;\n\tconst shippingPerCase = (basePrice &gt; shippingMethod.discountThreshold) ? shippingMethod.discountedFee : shippingMethod.feePerCase;\n\tconst shippingCost = quantity * shippingPerCase;\n\tconst price = basePrice - discount + shippingCost;\n\treturn price;\n}\n\n\n// 将第二简短的代码提炼出来（配送）\n\nfunction priceOrder(product, quantity, shippingMethod) {\n\tconst basePrice = product.basePrice * quantity;\n\tconst discount = Math.max(quantity - product.discountThreshold, 0) * product.basePrice * product.discountRate;\n\tconst price = applyShipping(basePrice, shippingMethod, quantity, discount);\n\treturn price;\n}\n\nfunction applyShipping(basePrice, shippingMethod, quantity, discount) {\n\tconst shippingPerCase = (basePrice &gt; shippingMethod.discountThreshold) ? shippingMethod.discountedFee : shippingMethod.feePerCase;\n\tconst shippingCost = quantity * shippingPerCase;\n\tconst price = basePrice - discount + shippingCost;\n\treturn price;\n}\n\n// 引入中转结构\nfunction priceOrder(product, quantity, shippingMethod) {\n\tconst basePrice = product.basePrice * quantity;\n\tconst discount = Math.max(quantity - product.discountThreshold, 0) * product.basePrice * product.discountRate;\n\tconst priceData = {basePrice, quantity, discount};\n\tconst price = applyShipping(priceData, shippingMethod);\n\treturn price;\n}\n\nfunction applyShipping(priceData, shippingMethod) {\n\tconst shippingPerCase = (priceData.basePrice &gt; shippingMethod.discountThreshold) ? shippingMethod.discountedFee : shippingMethod.feePerCase;\n\tconst shippingCost = priceData.quantity * shippingPerCase;\n\tconst price = priceData.basePrice - priceData.discount + shippingCost;\n\treturn price;\n}\n\n// 提炼第一阶段代码作为独立函数\nfunction priceOrder(product, quantity, shippingMethod) {\n    const priceData = calculatePricingData(product, quantity);\n\tconst price = applyShipping(priceData, shippingMethod);\n\treturn price;\n}\n\nfunction calculatePricingData(product, quantity) {\n\tconst basePrice = product.basePrice * quantity;\n\tconst discount = Math.max(quantity - product.discountThreshold, 0) * product.basePrice * product.discountRate;\n\treturn {basePrice, quantity, discount};\n}\n\nfunction applyShipping(priceData, shippingMethod) {\n\tconst shippingPerCase = (priceData.basePrice &gt; shippingMethod.discountThreshold) ? shippingMethod.discountedFee : shippingMethod.feePerCase;\n\tconst shippingCost = priceData.quantity * shippingPerCase;\n\tconst price = priceData.basePrice - priceData.discount + shippingCost;\n\treturn price;\n}\n\n// 洁癖，删除price变量\nfunction priceOrder(product, quantity, shippingMethod) {\n    const priceData = calculatePricingData(product, quantity);\n\treturn applyShipping(priceData, shippingMethod);\n}\n\nfunction calculatePricingData(product, quantity) {\n\tconst basePrice = product.basePrice * quantity;\n\tconst discount = Math.max(quantity - product.discountThreshold, 0) * product.basePrice * product.discountRate;\n\treturn {basePrice, quantity, discount};\n}\n\nfunction applyShipping(priceData, shippingMethod) {\n\tconst shippingPerCase = (priceData.basePrice &gt; shippingMethod.discountThreshold) ? shippingMethod.discountedFee : shippingMethod.feePerCase;\n\tconst shippingCost = priceData.quantity * shippingPerCase;\n\treturn priceData.basePrice - priceData.discount + shippingCost;\n}</code>\n        </deckgo-highlight-code>"}}]}},"pageContext":{"dir":"/重构 改善既有代码的设计 第2版/i","filePath":"/重构 改善既有代码的设计 第2版/第06章 第 一组重构/","name":"重构 改善既有代码的设计 第2版"}},"staticQueryHashes":["3159585216","3810076356"]}