{"componentChunkName":"component---src-templates-note-js","path":"/notes/重构 改善既有代码的设计 第2版/8","result":{"data":{"dir":{"distinct":["重构 改善既有代码的设计 第2版/第01章 重构，第 一个示例","重构 改善既有代码的设计 第2版/第02章 重构的原则 ","重构 改善既有代码的设计 第2版/第03章 代码的坏味道","重构 改善既有代码的设计 第2版/第04章 构筑测试体系","重构 改善既有代码的设计 第2版/第05章 介绍重构名录","重构 改善既有代码的设计 第2版/第06章 第 一组重构","重构 改善既有代码的设计 第2版/第07章 封装","重构 改善既有代码的设计 第2版/第08章 搬移特性","重构 改善既有代码的设计 第2版/第09章 重新组织数据","重构 改善既有代码的设计 第2版/第10章 简化条件逻辑","重构 改善既有代码的设计 第2版/第11章 重构API","重构 改善既有代码的设计 第2版/第12章 处理继承关系"]},"note":{"edges":[{"node":{"frontmatter":{"title":"","date":"2019-05-11","author":null},"html":"<h2 id=\"搬移函数（move-function）\" style=\"position:relative;\"><a href=\"#%E6%90%AC%E7%A7%BB%E5%87%BD%E6%95%B0%EF%BC%88move-function%EF%BC%89\" aria-label=\"搬移函数（move function） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E6%90%AC%E7%A7%BB%E5%87%BD%E6%95%B0%EF%BC%88move-function%EF%BC%89\" aria-label=\"搬移函数（move function） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>搬移函数（Move Function）</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">class Account {\n\tget overdraftCharge() {...}\n}\n\n\n\nclass AccountType {\n\tget overdraftCharge() {...}\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA\" aria-label=\"动机 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA\" aria-label=\"动机 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<h3 id=\"做法\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95\" aria-label=\"做法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95\" aria-label=\"做法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>检查函数在当前上下文里引用的所有程序元素，考虑是否需要将它们一并搬移</li>\n<li>检查待搬移函数是否具备多态性</li>\n<li>将函数复制一份到目标上下文中。调整函数，使它能适应新家</li>\n<li>执行静态检查</li>\n<li>设法从源上下文中正确引用目标函数</li>\n<li>修改源函数，使之成为一个纯委托函数</li>\n<li>测试</li>\n<li>考虑对源函数使用内联函数</li>\n</ul>\n<h3 id=\"范例\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B\" aria-label=\"范例 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B\" aria-label=\"范例 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function trackSummary(pointer) {\n\tconst totalTime = calculateTime();\n\tconst totalDistance = calculateDistance();\n\tconst pace = totalTime / 60 / totalDistance;\n\n\treturn {\n\t\ttime: totalTime,\n\t\tdistance: totalDistance,\n\t\tpace: pace\n\t};\n\n\n\tfunction calculateDistance() {\n\t\tlet result = 0;\n\t\tfor (let i = 1; i &lt; points.length; i++) {\n\t\t\tresult += distance(points[i-1], points[i]);\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction distance(p1, p2) {...}\n\tfunction radians(degrees) {...}\n\tfunction calculateTime() {...}\n}\n\n\n// 重构后\n\nfunction trackSummary(pointer) {\n\tconst totalTime = calculateTime();\n\tconst totalDistance = calculateDistance();\n\tconst pace = totalTime / 60 / totalDistance;\n\n\treturn {\n\t\ttime: totalTime,\n\t\tdistance: totalDistance,\n\t\tpace: pace\n\t};\n\n\tfunction distance(p1, p2) {...}\n\tfunction radians(degrees) {...}\n\tfunction calculateTime() {...}\n}\n\n\nfunction calculateDistance() {\n\tlet result = 0;\n\tfor (let i = 1; i &lt; points.length; i++) {\n\t\tresult += distance(points[i-1], points[i]);\n\t}\n\treturn result;\n}</code>\n        </deckgo-highlight-code>\n<h2 id=\"搬移字段（move-field）\" style=\"position:relative;\"><a href=\"#%E6%90%AC%E7%A7%BB%E5%AD%97%E6%AE%B5%EF%BC%88move-field%EF%BC%89\" aria-label=\"搬移字段（move field） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E6%90%AC%E7%A7%BB%E5%AD%97%E6%AE%B5%EF%BC%88move-field%EF%BC%89\" aria-label=\"搬移字段（move field） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>搬移字段（Move Field）</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">class Customer {\n\tget plan() { return this._plan;}\n\tget discountRate() { return this._discountRate; }\n}\n\n\n\n\nclass Customer {\n\tget plan() { return this._plan; }\n\tget discountRate() { return this.plan.discountRate; }\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-1\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-1\" aria-label=\"动机 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-1\" aria-label=\"动机 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<h3 id=\"做法-1\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-1\" aria-label=\"做法 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-1\" aria-label=\"做法 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<h3 id=\"范例-1\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-1\" aria-label=\"范例 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-1\" aria-label=\"范例 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<h2 id=\"搬移语句到函数（move-statements-into-function）\" style=\"position:relative;\"><a href=\"#%E6%90%AC%E7%A7%BB%E8%AF%AD%E5%8F%A5%E5%88%B0%E5%87%BD%E6%95%B0%EF%BC%88move-statements-into-function%EF%BC%89\" aria-label=\"搬移语句到函数（move statements into function） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E6%90%AC%E7%A7%BB%E8%AF%AD%E5%8F%A5%E5%88%B0%E5%87%BD%E6%95%B0%EF%BC%88move-statements-into-function%EF%BC%89\" aria-label=\"搬移语句到函数（move statements into function） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>搬移语句到函数（Move Statements into Function）</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">result.push(`&lt;p&gt;title: ${person.photo.title}&lt;/p&gt;`);\nresult.concat(photoData(person.photo));\n\nfunction photoData(aPhoto) {\n\treturn [\n\t\t`&lt;p&gt;locationo: ${aPhoto.location}&lt;/p&gt;`,\n\t\t`&lt;p&gt;date: ${aPhoto.date.toDateString()}&lt;/p&gt;`,\n\t];\n}\n\n\n\nresult.concat(photoData(person.photo));\n\nfunction photoData(aPhoto) {\n\treturn [\n\t    `&lt;p&gt;title: ${aPhoto.title}&lt;/p&gt;`,\n\t\t`&lt;p&gt;locationo: ${aPhoto.location}&lt;/p&gt;`,\n\t\t`&lt;p&gt;date: ${aPhoto.date.toDateString()}&lt;/p&gt;`,\n\t];\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-2\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-2\" aria-label=\"动机 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-2\" aria-label=\"动机 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<h3 id=\"做法-2\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-2\" aria-label=\"做法 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-2\" aria-label=\"做法 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<h3 id=\"范例-2\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-2\" aria-label=\"范例 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-2\" aria-label=\"范例 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<h2 id=\"搬移语句到调用者（move-statements-into-callers）\" style=\"position:relative;\"><a href=\"#%E6%90%AC%E7%A7%BB%E8%AF%AD%E5%8F%A5%E5%88%B0%E8%B0%83%E7%94%A8%E8%80%85%EF%BC%88move-statements-into-callers%EF%BC%89\" aria-label=\"搬移语句到调用者（move statements into callers） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E6%90%AC%E7%A7%BB%E8%AF%AD%E5%8F%A5%E5%88%B0%E8%B0%83%E7%94%A8%E8%80%85%EF%BC%88move-statements-into-callers%EF%BC%89\" aria-label=\"搬移语句到调用者（move statements into callers） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>搬移语句到调用者（Move Statements into Callers）</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">emitPhotoData(outStream, person.photo);\n\nfunction emitPhotoData(outStream, photo) {\n\toutStream.write(`&lt;p&gt;title: ${photo.title}&lt;/p&gt;`);\n\toutStream.write(`&lt;p&gt;location: ${photo.location}&lt;/p&gt;`);\n}\n\n\nemitPhotoData(outStream, person.photo);\noutStream.write(`&lt;p&gt;location: ${person.photo.location}&lt;/p&gt;`);\n\nfunction emitPhotoData(outStream, photo) {\n\toutStream.write(`&lt;p&gt;title: ${photo.title}&lt;/p&gt;`);\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-3\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-3\" aria-label=\"动机 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-3\" aria-label=\"动机 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<h3 id=\"做法-3\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-3\" aria-label=\"做法 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-3\" aria-label=\"做法 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<h3 id=\"范例-3\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-3\" aria-label=\"范例 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-3\" aria-label=\"范例 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function renderPerson(outStream, person) {\n\toutStream.wriete(`&lt;p&gt;${person.name}&lt;/p&gt;\\n`);\n\trenderPhoto(outStream, person.photo);\n\temitPhotoData(outStream, person.photo);\n}\n\n\nfunction listRecentPhotos(outStream, photos) {\n\tphotos\n\t.filter(p =&gt; p.date &gt; recentDateCutoff())\n\t.forEach(p =&gt; {\n\t\toutStream.write(&quot;&lt;div&gt;\\n&quot;);\n\t\temitPhotoData(outStream, p);\n\t\toutStream.write(&quot;&lt;/div&gt;\\n&quot;);\n\t})\n}\n\n\nfunction emitPhotoData(outStream, photo) {\n\toutStream.write(`&lt;p&gt;title: ${photo.title}&lt;/p&gt;\\n`);\n\toutStream.write(`&lt;p&gt;date: ${photo.date.toDateString()}&lt;/p&gt;\\n`);\n\toutStream.write(`&lt;p&gt;location: ${photo.location}&lt;/p&gt;\\n`);\n}\n\n\n// 重构后\nfunction renderPerson(outStream, person) {\n\toutStream.wriete(`&lt;p&gt;${person.name}&lt;/p&gt;\\n`);\n\trenderPhoto(outStream, person.photo);\n\temitPhotoData(outStream, person.photo);\n\toutStream.write(`&lt;p&gt;location: ${photo.location}&lt;/p&gt;\\n`);\n}\n\n\nfunction listRecentPhotos(outStream, photos) {\n\tphotos\n\t.filter(p =&gt; p.date &gt; recentDateCutoff())\n\t.forEach(p =&gt; {\n\t\toutStream.write(&quot;&lt;div&gt;\\n&quot;);\n\t\temitPhotoData(outStream, p);\n\t\toutStream.write(`&lt;p&gt;location: ${photo.location}&lt;/p&gt;\\n`);\n\t\toutStream.write(&quot;&lt;/div&gt;\\n&quot;);\n\t})\n}\n\n\nfunction emitPhotoData(outStream, photo) {\n\toutStream.write(`&lt;p&gt;title: ${photo.title}&lt;/p&gt;\\n`);\n\toutStream.write(`&lt;p&gt;date: ${photo.date.toDateString()}&lt;/p&gt;\\n`);\n}\n</code>\n        </deckgo-highlight-code>\n<h2 id=\"移动语句（slide-statements）\" style=\"position:relative;\"><a href=\"#%E7%A7%BB%E5%8A%A8%E8%AF%AD%E5%8F%A5%EF%BC%88slide-statements%EF%BC%89\" aria-label=\"移动语句（slide statements） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E7%A7%BB%E5%8A%A8%E8%AF%AD%E5%8F%A5%EF%BC%88slide-statements%EF%BC%89\" aria-label=\"移动语句（slide statements） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>移动语句（Slide Statements）</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">const pricingPlan = retrievePricingPlan();\nconst order = retreiveOrder();\nlet charge;\nconst chargePerUnit = pricingPlan.unit;\n\n\nconst pricingPlan = retrievePricingPlan();\nconst chargePerUnit = pricingPlan.unit;\nconst order = retreiveOrder();\nlet charge;</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-4\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-4\" aria-label=\"动机 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-4\" aria-label=\"动机 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<p>让存在关联的东西一起出现，可以使代码更容易理解。</p>\n<h3 id=\"做法-4\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-4\" aria-label=\"做法 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-4\" aria-label=\"做法 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>先看看，移动后是否会影响代码的正常工作。如果会，就放弃移动</li>\n<li>剪切源代码片段，粘贴到上一步选定的位置上。</li>\n<li>测试</li>\n</ul>\n<h3 id=\"范例-4\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-4\" aria-label=\"范例 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-4\" aria-label=\"范例 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<p>移动代码时，要想清楚两件事：</p>\n<ol>\n<li>调整的目标是什么，以及该目标能否达成</li>\n<li>移动后，代码之间产生的干扰</li>\n</ol>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">1 const pricingPlan = retrievePricingPlan();\n2 const order = retrieveOrder();\n3 const baseCharge = pricingPlan.base;\n4 let charge;\n5 const chargePerUnit = pricingPlan.unit;\n6 const units =order.units;\n7 let discount;\n8 charge = baseCharge + units * chargePerUnit;\n9 let discountableUnits = Math.max(units, pricingPlan.discountThreshold, 0);\n10 discount = discountableUnits * pricingPlan.discountFactor;\n11 if( order.isRepeat) discount += 20;\n12 charge = charge - discount;\n13 chargeOrder(charge);</code>\n        </deckgo-highlight-code>\n<p>移动时，注意移动语句的变量，在上下文中有没有被修改</p>\n<h3 id=\"范例-包含条件逻辑的移动\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-%E5%8C%85%E5%90%AB%E6%9D%A1%E4%BB%B6%E9%80%BB%E8%BE%91%E7%9A%84%E7%A7%BB%E5%8A%A8\" aria-label=\"范例 包含条件逻辑的移动 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-%E5%8C%85%E5%90%AB%E6%9D%A1%E4%BB%B6%E9%80%BB%E8%BE%91%E7%9A%84%E7%A7%BB%E5%8A%A8\" aria-label=\"范例 包含条件逻辑的移动 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例 包含条件逻辑的移动</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">let result;\nif (avaliableResources.length === 0) {\n\tresult = createResource();\n\tallocatedResources.push(result);\n} else {\n\tresult = avaliableResources.pop();\n\tavaliableResources.push(result);\n}\n\nlet result;\nif (avaliableResources.length === 0) {\n\tresult = createResource();\n} else {\n\tresult = avaliableResources.pop();\n}\n\nallocatedResources.push(result);</code>\n        </deckgo-highlight-code>\n<h2 id=\"拆分循环（split-loop）\" style=\"position:relative;\"><a href=\"#%E6%8B%86%E5%88%86%E5%BE%AA%E7%8E%AF%EF%BC%88split-loop%EF%BC%89\" aria-label=\"拆分循环（split loop） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E6%8B%86%E5%88%86%E5%BE%AA%E7%8E%AF%EF%BC%88split-loop%EF%BC%89\" aria-label=\"拆分循环（split loop） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>拆分循环（Split Loop）</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">let averageAge = 0;\nlet totalSalary = 0;\nfor (const p of people) {\n\taverageAge += p.age;\n\ttotalSalary += p.salary;\n}\n\naverageAge = averageAge / people.length;\n\n\n\nlet totalSalary = 0;\nfor (const p of people) {\n\ttotalSalary += p.salary;\n}\n\nlet averageAge = 0;\nfor (const p of people) {\n\taverageAge += p.age;\n}\n\naverageAge = averageAge / people.length</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-5\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-5\" aria-label=\"动机 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-5\" aria-label=\"动机 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<p>一个循环，只做一件事</p>\n<h3 id=\"做法-5\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-5\" aria-label=\"做法 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-5\" aria-label=\"做法 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>赋值一遍循环代码</li>\n<li>识别并移除循环中的重复代码，使每个循环只做一件事</li>\n<li>测试</li>\n</ul>\n<h3 id=\"范例-5\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-5\" aria-label=\"范例 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-5\" aria-label=\"范例 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<h2 id=\"以管道取代循环（replace-loop-with-pipeline）\" style=\"position:relative;\"><a href=\"#%E4%BB%A5%E7%AE%A1%E9%81%93%E5%8F%96%E4%BB%A3%E5%BE%AA%E7%8E%AF%EF%BC%88replace-loop-with-pipeline%EF%BC%89\" aria-label=\"以管道取代循环（replace loop with pipeline） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E4%BB%A5%E7%AE%A1%E9%81%93%E5%8F%96%E4%BB%A3%E5%BE%AA%E7%8E%AF%EF%BC%88replace-loop-with-pipeline%EF%BC%89\" aria-label=\"以管道取代循环（replace loop with pipeline） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>以管道取代循环（Replace Loop with Pipeline）</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">const names = [];\nfor (const i of input) {\n\tif (i.job === &quot;programmer&quot;) {\n\t   name.push(i.name);\n\t}\n}\n\n\nconst names = input\n.filter(i =&gt; i.job === &#39;programmer&#39;)\n.map(i =&gt; i.name);\n</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-6\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-6\" aria-label=\"动机 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-6\" aria-label=\"动机 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<p>map 用一个函数作用域输入集合的每一个元素上，将集合变换成另外一个集合的过程\nfilter 用一个函数从输入集合中筛选出符合条件的元素子集</p>\n<h3 id=\"做法-6\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-6\" aria-label=\"做法 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-6\" aria-label=\"做法 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>创建一个新变量，用以存放参与循环过程的集合</li>\n<li>从循环顶部开始，将循环里的每一块行为依次搬移出来，在上异步创建的集合变量上用一种管道运算替代之。每次修改后运行测试</li>\n<li>搬移完循环里的全部行为后，将循环整个删除。</li>\n</ul>\n<h3 id=\"范例-6\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-6\" aria-label=\"范例 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-6\" aria-label=\"范例 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<p>csv文件，保存办公室的数据</p>\n<deckgo-highlight-code csv  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">office, country, telephone\nChicago, USA,  +1 312 373 1000\nBeijing, China, +86 4008 900 505\nBangalore, India, +91 80 4064 9570\nPorto Alegre, Brazil, +55 51 3079 3550\nChennai, India, +91 44 660 44766</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function acquireData(input) {\n\tconst lines = input.split(&quot;\\n&quot;);\n\tlet firstLine = true;\n\tconst result = [];\n\tfor (const line of lines) {\n\t\tif (firstLine) {\n\t\t\tfirstLine = false;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (line.trim() === &quot;&quot;) continue;\n\t\tconst record = line.split(&quot;,&quot;);\n\t\tif (record[1].trim() === &quot;India&quot;) {\n\t\t\tresult.push({city: record[0].trim(), phone: record[2].trim()});\n\t\t}\n\t}\n\treturn result;\n}\n\n// 先想想怎么重构？\n\n// 1. 创建一个新变量，用以存放参与循环过程的集合\nfunction acquireData(input) {\n\tconst lines = input.split(&quot;\\n&quot;);\n\tlet firstLine = true;\n\tconst result = [];\n\tconst loopItems = lines; // 新变量\n\tfor (const line of loopItems) {\n\t\tif (firstLine) {\n\t\t\tfirstLine = false;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (line.trim() === &quot;&quot;) continue;\n\t\tconst record = line.split(&quot;,&quot;);\n\t\tif (record[1].trim() === &quot;India&quot;) {\n\t\t\tresult.push({city: record[0].trim(), phone: record[2].trim()});\n\t\t}\n\t}\n\treturn result;\n}\n\n// 2. 移除第一行\nfunction acquireData(input) {\n\tconst lines = input.split(&quot;\\n&quot;);\n\tconst result = [];\n\tconst loopItems = lines.slice(1); // 移除第一行\n\tfor (const line of loopItems) {\n\t\tif (line.trim() === &quot;&quot;) continue;\n\t\tconst record = line.split(&quot;,&quot;);\n\t\tif (record[1].trim() === &quot;India&quot;) {\n\t\t\tresult.push({city: record[0].trim(), phone: record[2].trim()});\n\t\t}\n\t}\n\treturn result;\n}\n\n// 3. 移除空判断\nfunction acquireData(input) {\n\tconst lines = input.split(&quot;\\n&quot;);\n\tconst result = [];\n\tconst loopItems = lines.slice(1).filter(line =&gt; line.trim() !== &quot;&quot;);\n\tfor (const line of loopItems) {\n\t\tconst record = line.split(&quot;,&quot;);\n\t\tif (record[1].trim() === &quot;India&quot;) {\n\t\t\tresult.push({city: record[0].trim(), phone: record[2].trim()});\n\t\t}\n\t}\n\treturn result;\n}\n// 4. 移除记录拆分\nfunction acquireData(input) {\n\tconst lines = input.split(&quot;\\n&quot;);\n\tconst result = [];\n\tconst loopItems = lines.slice(1)\n\t.filter(line =&gt; line.trim() !== &quot;&quot;)\n\t.map(line =&gt; line.split(&quot;,&quot;))\n\t;\n\tfor (const line of loopItems) {\n\t\tif (record[1].trim() === &quot;India&quot;) {\n\t\t\tresult.push({city: record[0].trim(), phone: record[2].trim()});\n\t\t}\n\t}\n\treturn result;\n}\n// 5. 移除过滤语句\nfunction acquireData(input) {\n\tconst lines = input.split(&quot;\\n&quot;);\n\tconst result = [];\n\tconst loopItems = lines.slice(1)\n\t.filter(line =&gt; line.trim() !== &quot;&quot;)\n\t.map(line =&gt; line.split(&quot;,&quot;))\n\t.filter(record =&gt; record[1].trim() === &quot;India&quot;);\n\tfor (const line of loopItems) {\n\t\tresult.push({city: record[0].trim(), phone: record[2].trim()});\t\n\t}\n\treturn result;\n}\n\n// 6. 移除push\nfunction acquireData(input) {\n\tconst lines = input.split(&quot;\\n&quot;);\n\tconst result = [];\n\tconst loopItems = lines.slice(1)\n\t.filter(line =&gt; line.trim() !== &quot;&quot;)\n\t.map(line =&gt; line.split(&quot;,&quot;))\n\t.filter(record =&gt; record[1].trim() === &quot;India&quot;);\n\t.map(record =&gt; ({city: record[0].trim(), phone: record[2].trim()}));\n\tfor (const line of loopItems) {\n\t\tresult.push(line);\t\n\t}\n\treturn result;\n}\n\n// 7. 移除for\nfunction acquireData(input) {\n\tconst lines = input.split(&quot;\\n&quot;);\n\tconst result = lines.slice(1)\n\t.filter(line =&gt; line.trim() !== &quot;&quot;)\n\t.map(line =&gt; line.split(&quot;,&quot;))\n\t.filter(record =&gt; record[1].trim() === &quot;India&quot;);\n\t.map(record =&gt; ({city: record[0].trim(), phone: record[2].trim()}));\n\treturn result;\n}\n\n// 8. 移除变量\nfunction acquireData(input) {\n\tconst lines = input.split(&quot;\\n&quot;);\n\treturn lines.slice(1)\n\t.filter(line =&gt; line.trim() !== &quot;&quot;)\n\t.map(line =&gt; line.split(&quot;,&quot;))\n\t.filter(record =&gt; record[1].trim() === &quot;India&quot;);\n\t.map(record =&gt; ({city: record[0].trim(), phone: record[2].trim()}));\n}</code>\n        </deckgo-highlight-code>\n<p>// 性能测试</p>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">const csv = &quot;office, country, telephone\\nChicago, USA,  +1 312 373 1000Beijing, China, +86 4008 900 505\\nBangalore, India, +91 80 4064 9570\\nPorto Alegre, Brazil, +55 51 3079 3550\\nChennai, India, +91 44 660 44766&quot;;\n\nfunction acquireData1(input) {\n    const startDate = new Date().getTime();\n\tconst lines = input.split(&quot;\\n&quot;);\n\tlet firstLine = true;\n\tconst result = [];\n\tfor (const line of lines) {\n\t\tif (firstLine) {\n\t\t\tfirstLine = false;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (line.trim() === &quot;&quot;) continue;\n\t\tconst record = line.split(&quot;,&quot;);\n\t\tif (record[1].trim() === &quot;India&quot;) {\n\t\t\tresult.push({city: record[0].trim(), phone: record[2].trim()});\n\t\t}\n\t}\n\tconsole.log(new Date().getTime() - startDate);\n\treturn result;\n}\n\nfunction acquireData2(input) {\n\tconst lines = input.split(&quot;\\n&quot;);\n\treturn lines.slice(1)\n\t.filter(line =&gt; line.trim() !== &quot;&quot;)\n\t.map(line =&gt; line.split(&quot;,&quot;))\n\t.filter(record =&gt; record[1].trim() === &quot;India&quot;);\n\t.map(record =&gt; ({city: record[0].trim(), phone: record[2].trim()}));\n}\nconsole.log(acquireData2(csv));\n</code>\n        </deckgo-highlight-code>\n<h2 id=\"移除死代码（remove-dead-code）\" style=\"position:relative;\"><a href=\"#%E7%A7%BB%E9%99%A4%E6%AD%BB%E4%BB%A3%E7%A0%81%EF%BC%88remove-dead-code%EF%BC%89\" aria-label=\"移除死代码（remove dead code） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E7%A7%BB%E9%99%A4%E6%AD%BB%E4%BB%A3%E7%A0%81%EF%BC%88remove-dead-code%EF%BC%89\" aria-label=\"移除死代码（remove dead code） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>移除死代码（Remove Dead Code）</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">if (false) {\n  doSomethingThatUsedToMatter();\n}\n</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-7\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-7\" aria-label=\"动机 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-7\" aria-label=\"动机 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<p>一旦代码不再被使用，立马删除它。</p>\n<h3 id=\"做法-7\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-7\" aria-label=\"做法 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-7\" aria-label=\"做法 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>如果死代码可以从外部直接引用，先查找引用点。</li>\n<li>将死代码移除</li>\n<li>测试</li>\n</ul>\n<h3 id=\"范例-7\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-7\" aria-label=\"范例 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-7\" aria-label=\"范例 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>"}}]}},"pageContext":{"dir":"/重构 改善既有代码的设计 第2版/i","filePath":"/重构 改善既有代码的设计 第2版/第08章 搬移特性/","name":"重构 改善既有代码的设计 第2版"}},"staticQueryHashes":["3159585216","3810076356"]}