{"componentChunkName":"component---src-templates-note-js","path":"/notes/重构 改善既有代码的设计 第2版/11","result":{"data":{"dir":{"distinct":["重构 改善既有代码的设计 第2版/第01章 重构，第 一个示例","重构 改善既有代码的设计 第2版/第02章 重构的原则 ","重构 改善既有代码的设计 第2版/第03章 代码的坏味道","重构 改善既有代码的设计 第2版/第04章 构筑测试体系","重构 改善既有代码的设计 第2版/第05章 介绍重构名录","重构 改善既有代码的设计 第2版/第06章 第 一组重构","重构 改善既有代码的设计 第2版/第07章 封装","重构 改善既有代码的设计 第2版/第08章 搬移特性","重构 改善既有代码的设计 第2版/第09章 重新组织数据","重构 改善既有代码的设计 第2版/第10章 简化条件逻辑","重构 改善既有代码的设计 第2版/第11章 重构API","重构 改善既有代码的设计 第2版/第12章 处理继承关系"]},"note":{"edges":[{"node":{"frontmatter":{"title":"","date":"2019-05-14"},"html":"<h2 id=\"将查询函数和修改函数分离separate-query-from-modifier\" style=\"position:relative;\"><a href=\"#%E5%B0%86%E6%9F%A5%E8%AF%A2%E5%87%BD%E6%95%B0%E5%92%8C%E4%BF%AE%E6%94%B9%E5%87%BD%E6%95%B0%E5%88%86%E7%A6%BBseparate-query-from-modifier\" aria-label=\"将查询函数和修改函数分离separate query from modifier permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%B0%86%E6%9F%A5%E8%AF%A2%E5%87%BD%E6%95%B0%E5%92%8C%E4%BF%AE%E6%94%B9%E5%87%BD%E6%95%B0%E5%88%86%E7%A6%BBseparate-query-from-modifier\" aria-label=\"将查询函数和修改函数分离separate query from modifier permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>将查询函数和修改函数分离(Separate Query from Modifier)</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function getTotalOutstandingAndSendBill() {\n\tconst result = customer.invoices.reduce((total, each) =&gt; each.amount + total, 0);\n\tsendBill();\n\treturn result;\n}\n\n\nfunction totalOutstanding() {\n\treturn customer.invoices.reduce((total, each) =&gt; each.amount + total, 0);\n}\n\nfunction sendBill() {\n\temailGateway.send(formatBill(customer));\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA\" aria-label=\"动机 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA\" aria-label=\"动机 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<p>无副作用：无副作用函数，是指那些不使用类的成员，不使用全局变量变化的函数。\n有副作用：</p>\n<p>任何有返回值的函数，都不应该有看的到的副作用</p>\n<h3 id=\"做法\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95\" aria-label=\"做法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95\" aria-label=\"做法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>复制整个函数，将其作为一个查询来命名</li>\n<li>从新建的查询函数中去掉所有造成副作用的语句</li>\n<li>执行静态检查</li>\n<li>查找所有调用原函数地方，将其修改为新建的查询函数。每次修改之后都要测试</li>\n<li>从原函数中去掉返回值</li>\n<li>测试</li>\n</ul>\n<h3 id=\"范例\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B\" aria-label=\"范例 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B\" aria-label=\"范例 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function alertForMiscreant(people) {\n\tfor (const p of people) {\n\t\tif(p === &quot;Don&quot;) {\n\t\t\tsetOffAlarms();\n\t\t\treturn &quot;Don&quot;;\n\t\t}\n\n\t\tif(p === &quot;John&quot;) {\n\t\t\tsetOffAlarms();\n\t\t\treturn &quot;John&quot;\n\t\t}\n\t}\n\treturn &quot;&quot;\n}\n\n// 1. 复制整个函数， 以查询来命名\nfunction findMiscreant(people) {\n\tfor (const p of people) {\n\t\tif(p === &quot;Don&quot;) {\n\t\t\tsetOffAlarms();\n\t\t\treturn &quot;Don&quot;;\n\t\t}\n\n\t\tif(p === &quot;John&quot;) {\n\t\t\tsetOffAlarms();\n\t\t\treturn &quot;John&quot;\n\t\t}\n\t}\n\treturn &quot;&quot;\n}\n\n// 2. 在新建的查询函数中去掉副作用\nfunction findMiscreant(people) {\n\tfor (const p of people) {\n\t\tif(p === &quot;Don&quot;) {\n\t\t\t// setOffAlarms();\n\t\t\treturn &quot;Don&quot;;\n\t\t}\n\n\t\tif(p === &quot;John&quot;) {\n\t\t\t// setOffAlarms();\n\t\t\treturn &quot;John&quot;\n\t\t}\n\t}\n\treturn &quot;&quot;\n}\n\n// 3. 修改原来的调用者，\nconst found = alertForMiscreant(people);\n\nconst found = findMiscreant(people);\nalertForMiscreant(people);\n\n// 4. 删除返回值\nfunction alertForMiscreant(people) {\n\tfor (const p of people) {\n\t\tif(p === &quot;Don&quot;) {\n\t\t\tsetOffAlarms();\n\t\t\treturn;\n\t\t}\n\n\t\tif(p === &quot;John&quot;) {\n\t\t\tsetOffAlarms();\n\t\t\treturn;\n\t\t}\n\t}\n\treturn;\n}\n\n// 5. 删除重复代码\nfunction alertForMiscreant(people) {\n\tif(findMiscreant(people) !== &quot;&quot;) setOffAlarms();\n}</code>\n        </deckgo-highlight-code>\n<h2 id=\"函数参数化parameterize-function\" style=\"position:relative;\"><a href=\"#%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E5%8C%96parameterize-function\" aria-label=\"函数参数化parameterize function permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E5%8C%96parameterize-function\" aria-label=\"函数参数化parameterize function permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>函数参数化(Parameterize Function)</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function tenPercentRaise(aPerson) {\n\taPerson.salary = aPerson.salary.multiply(1.1);\n}\n\nfunction fivePercentRaise(aPerson) {\n\taPerson.salary = aPerson.salary.multiply(1.05);\n}\n\n\nfunction raise(aPerson, factor) {\n\taPerson.salary = aPerson.salary.multiply(1 + factor);\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-1\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-1\" aria-label=\"动机 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-1\" aria-label=\"动机 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<p>如果发现两个函数逻辑非常相似，只有一些字面量不同，可以将其合并成一个函数，以参数的形式传入不同的值，从而消除重复。</p>\n<h3 id=\"做法-1\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-1\" aria-label=\"做法 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-1\" aria-label=\"做法 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>从一组相似的函数中选择一个</li>\n<li>运用改变函数声明，把需要作为参数传入的字面量添加到参数列表中</li>\n<li>修改该函数所有的调用处，使其在调用时传入该字面量值</li>\n<li>测试</li>\n<li>修改函数体，令其使用新传入的参数。每使用一个新参数都要测试</li>\n<li>对于其他与之相似的函数，注意将其调用处改为调用已经参数化的函数。每次修改后都要测试。</li>\n</ul>\n<h3 id=\"范例-1\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-1\" aria-label=\"范例 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-1\" aria-label=\"范例 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function baseCharge(usage) {\n\tif(usage &lt; 0) return usd(0);\n\tconst amount = bottomBand(usage) * 0.03\n\t+ middleBand(usage) * 0.05\n\t+ topBand(usage) * 0.07;\n\treturn usd(amount);\n}\n\nfunction bottomBand(usage) {\n\treturn Math.min(usage, 100);\n}\n\nfunction middleBand(usage) {\n\trturn usage &gt; 100 ? Math.min(usage, 200) - 100 : 0;\n}\n\nfunction topBand(usage) {\n\treturn usage &gt; 200 ? usage - 200 : 0;\n}\n\n// 重构后\nfunction withinBand(usage, bottom, top) {\n  return usage &gt; bottom ? Math.min(usage, top) - bottom : 0;\n}\n\n\nfunction withinBand(usage, bottom, top) {\n  return usage &gt; bottom ? Math.min(usage, top) - bottom : 0;\n}\n\nfunction baseCharge(usage) {\n\tif(usage &lt; 0) return usd(0);\n\tconst amount = withinBand(usage, 0, 100) * 0.03\n\t+ withinBand(usage, 100, 200) * 0.05\n\t+ withinBand(usage, 200, Infinity) * 0.07;\n\treturn usd(amount);\n}</code>\n        </deckgo-highlight-code>\n<h2 id=\"移除标记参数remove-flag-argument\" style=\"position:relative;\"><a href=\"#%E7%A7%BB%E9%99%A4%E6%A0%87%E8%AE%B0%E5%8F%82%E6%95%B0remove-flag-argument\" aria-label=\"移除标记参数remove flag argument permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E7%A7%BB%E9%99%A4%E6%A0%87%E8%AE%B0%E5%8F%82%E6%95%B0remove-flag-argument\" aria-label=\"移除标记参数remove flag argument permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>移除标记参数(Remove Flag Argument)</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">\nfunction setDimension(name, value) {\n\tif(name === &quot;height&quot;) {\n\t\tthis._height = value;\n\t\treturn;\n\t}\n\n\tif(name === &quot;width&quot;) {\n\t\tthis._width = value;\n\t\treturn;\n\t}\n}\n\nfunction setHeight(value) { this._height = value; }\nfunction setWidth(value) { this._width = value; }\n</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-2\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-2\" aria-label=\"动机 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-2\" aria-label=\"动机 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<h3 id=\"做法-2\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-2\" aria-label=\"做法 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-2\" aria-label=\"做法 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>针对参数的每一种可能值，新建一个明确函数</li>\n<li>对于”用字面量值作为参数“的函数调用者，将其改为调用新建的明确函数</li>\n</ul>\n<h3 id=\"范例-2\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-2\" aria-label=\"范例 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-2\" aria-label=\"范例 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">aShipment.deliveryDate = deliveryDate(anOrder, true);\naShipment.deliveryDate = deliveryDate(anOrder, false);\n\nfunction deliveryDate(anOrder, isRush) {\n\tif(isRush) {\n\t\tlet deliveryTime;\n\t\tif([&quot;MA&quot;, &quot;CT&quot;].includes(anOrder.deliveryState)) deliveryTime = 1;\n\t\telse if([&quot;NY&quot;, &quot;NH&quot;].includes(anOrder.deliveryState)) deliveryState = 2;\n\t\telse deliveryTime = 3;\n\t\treturn anOrder.placedOn.plusDays(1 + deliveryTime);\n\t} else {\n\t\tlet deliveryTime;\n\t\tif([&quot;MA&quot;, &quot;CT&quot;, &quot;NY&quot;].includes(anOrder.deliveryState)) deliveryTime = 2;\n\t\telse if([&quot;ME&quot;, &quot;NH&quot;].includes(anOrder.deliveryState)) deliveryTime = 3;\n\t\telse deliveryTime = 4;\n\t\treturn anOrder.placedOn.plusDays(2 + deliveryTime);\n\t}\n}\n\n// 重构后：\n\naShipment.deliveryDate = rushDeliveryDate(anOrder);\naShipment.deliveryDate = regularDeliveryDate(anOrder);\n\nfunction rushDeliveryDate(anOrder) {\n\tlet deliveryTime;\n\tif([&quot;MA&quot;, &quot;CT&quot;].includes(anOrder.deliveryState)) deliveryTime = 1;\n\telse if([&quot;NY&quot;, &quot;NH&quot;].includes(anOrder.deliveryState)) deliveryState = 2;\n\telse deliveryTime = 3;\n\treturn anOrder.placedOn.plusDays(1 + deliveryTime);\n}\n\nfunction regularDeliveryDate(anOrder) {\n\tlet deliveryTime;\n\tif([&quot;MA&quot;, &quot;CT&quot;, &quot;NY&quot;].includes(anOrder.deliveryState)) deliveryTime = 2;\n\telse if([&quot;ME&quot;, &quot;NH&quot;].includes(anOrder.deliveryState)) deliveryTime = 3;\n\telse deliveryTime = 4;\n\treturn anOrder.placedOn.plusDays(2 + deliveryTime);\n}</code>\n        </deckgo-highlight-code>\n<h2 id=\"保持对象完整preserve-whole-object\" style=\"position:relative;\"><a href=\"#%E4%BF%9D%E6%8C%81%E5%AF%B9%E8%B1%A1%E5%AE%8C%E6%95%B4preserve-whole-object\" aria-label=\"保持对象完整preserve whole object permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E4%BF%9D%E6%8C%81%E5%AF%B9%E8%B1%A1%E5%AE%8C%E6%95%B4preserve-whole-object\" aria-label=\"保持对象完整preserve whole object permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>保持对象完整(Preserve Whole Object)</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">const low = aRoom.daysTempRange.low;\nconst high = aRoom.daysTempRange.high;\nif(aPlan.withinRange(low, high))\n\n\nif(aPlan.withinRange(aRoom.daysTempRange))</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-3\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-3\" aria-label=\"动机 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-3\" aria-label=\"动机 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<h3 id=\"做法-3\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-3\" aria-label=\"做法 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-3\" aria-label=\"做法 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>新建一个空函数，给它以期望中的参数列表</li>\n<li>在新函数体内调用旧函数，并把新的参数映射到旧的参数列表</li>\n<li>执行静态检查</li>\n<li>逐一修改就函数的调用者，令其使用新函数，每次修改之后执行测试</li>\n<li>所有调用者处都修改过来之后，使用内联函数把旧函数内联到新函数体内</li>\n<li>给新函数改名，从重构开始时的容易搜索的临时名字，改为使用旧函数的名字，同时修改所有调用者</li>\n</ul>\n<h3 id=\"范例-3\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-3\" aria-label=\"范例 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-3\" aria-label=\"范例 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<p>我们想象一个室温监控系统，它负责记录房间一天中的最高温度和最低温度，然后将实际的温度范围与预先规定的温度控制计划相比较，如果当天温度不符合计划要求，就发出警告。</p>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">const low = aRoom.daysTempRange.low;\nconst high = aRoom.daysTempRange.high;\nif(!aPlan.withinRange(low, high))\n\talerts.push(&quot;room temperature went outside range&quot;);\n\n\nclass HeatingPlan {\n\twithinRange(bottom, top) {\n\t\treturn (bottom &gt;= this._temperatureRange.low) &amp;&amp; (top &lt;= this._temperatureRange.high);\n\t}\n}\n\n// 重构后\n\nif(!aPlan.withinRange(aRoom.daysTempRange))\n\talerts.push(&quot;room temperature went outside range&quot;);\n\n\nclass HeatingPlan {\n\twithinRange(aNumberRange) {\n\t\treturn (aNumberRange.low &gt;= this._temperatureRange.low) &amp;&amp; (aNumberRange.high &lt;= this._temperatureRange.high);\n\t}\n}</code>\n        </deckgo-highlight-code>\n<h2 id=\"以查询取代参数replace-parameter-with-query\" style=\"position:relative;\"><a href=\"#%E4%BB%A5%E6%9F%A5%E8%AF%A2%E5%8F%96%E4%BB%A3%E5%8F%82%E6%95%B0replace-parameter-with-query\" aria-label=\"以查询取代参数replace parameter with query permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E4%BB%A5%E6%9F%A5%E8%AF%A2%E5%8F%96%E4%BB%A3%E5%8F%82%E6%95%B0replace-parameter-with-query\" aria-label=\"以查询取代参数replace parameter with query permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>以查询取代参数(Replace Parameter with Query)</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">\navailableVacation(anEmployee, anEmployee.grade);\n\nfunction availableVacation(anEmployee, grade) {\n\t// calculate vacation...\n}\n\n\n\navailableVacation(anEmployee)\n\nfunction availableVacation(anEmployee) {\n\tconst grade = anEmployee.grade;\n\t// calculate vacation...\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-4\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-4\" aria-label=\"动机 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-4\" aria-label=\"动机 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<h3 id=\"做法-4\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-4\" aria-label=\"做法 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-4\" aria-label=\"做法 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>如果有必要，使用提炼函数将参数的计算过程提炼到一个独立的函数中</li>\n<li>将函数体内引用该参数的地方改为调用新建的函数。每次修改后执行测试</li>\n<li>全部替换完成后，使用改变函数声明将该参数去掉</li>\n</ul>\n<h3 id=\"范例-4\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-4\" aria-label=\"范例 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-4\" aria-label=\"范例 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">class Order {\n\tget finalPrice() {\n\t\tconst basePrice = this.quantity * this.itemPrice;\n\t\tlet discountLevel;\n\t\tif(this.quantity &gt; 100) discountLevel = 2;\n\t\telse discountLevel = 1;\n\t\treturn this.discountedPrice(basePrice, discountLevel);\n\t}\n\n\tdiscountedPrice(basePrice, discountLevel) {\n\t\tswitch(discountLevel) {\n\t\t\tcase 1: return basePrice * 0.95;\n\t\t\tcase 2: return basePrice * 0.9;\n\t\t}\n\t}\n}\n\n// 重构后\nclass Order {\n\tget finalPrice() {\n\t\tconst basePrice = this.quantity * this.itemPrice;\n\t\treturn this.discountedPrice(basePrice, this.discountLevel);\n\t}\n\n\tget discountLevel() {\n\t\treturn this.quantity &gt; 100 ? 2 : 1;\n\t}\n\n\tdiscountedPrice(basePrice) {\n\t\tswitch(this.discountLevel) {\n\t\t\tcase 1: return basePrice * 0.95;\n\t\t\tcase 2: return basePrice * 0.9;\n\t\t}\n\t}\n}\n</code>\n        </deckgo-highlight-code>\n<h2 id=\"以参数取代查询replace-query-with-parameter\" style=\"position:relative;\"><a href=\"#%E4%BB%A5%E5%8F%82%E6%95%B0%E5%8F%96%E4%BB%A3%E6%9F%A5%E8%AF%A2replace-query-with-parameter\" aria-label=\"以参数取代查询replace query with parameter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E4%BB%A5%E5%8F%82%E6%95%B0%E5%8F%96%E4%BB%A3%E6%9F%A5%E8%AF%A2replace-query-with-parameter\" aria-label=\"以参数取代查询replace query with parameter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>以参数取代查询(Replace Query with Parameter)</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">targetTemperature(aPlan)\n\nfunction targetTemperature(aPlan) {\n\tcurrentTemperature = thermostat.currentTemperature;\n\t// rest of function...\n}\n\n\n\ntargetTemperature(aPlan, thermostat.currentTemperature)\n\nfunction targetTemperature(aPlan, currentTemperature) {\n\t// rest of function\n}\n</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-5\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-5\" aria-label=\"动机 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-5\" aria-label=\"动机 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<h3 id=\"做法-5\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-5\" aria-label=\"做法 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-5\" aria-label=\"做法 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<h3 id=\"范例-5\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-5\" aria-label=\"范例 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-5\" aria-label=\"范例 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<h2 id=\"移除设值函数remove-setting-method\" style=\"position:relative;\"><a href=\"#%E7%A7%BB%E9%99%A4%E8%AE%BE%E5%80%BC%E5%87%BD%E6%95%B0remove-setting-method\" aria-label=\"移除设值函数remove setting method permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E7%A7%BB%E9%99%A4%E8%AE%BE%E5%80%BC%E5%87%BD%E6%95%B0remove-setting-method\" aria-label=\"移除设值函数remove setting method permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>移除设值函数(Remove Setting Method)</h2>\n<p>class Person {\nget name() {…}\nset name(aString) {…}\n}</p>\n<p>class Person {\nget name() {…}\n}</p>\n<h3 id=\"动机-6\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-6\" aria-label=\"动机 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-6\" aria-label=\"动机 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<p>如果不希望咱对象创建之后此字段还有机会被改变，那就不要为它提供设值函数。</p>\n<h3 id=\"做法-6\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-6\" aria-label=\"做法 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-6\" aria-label=\"做法 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<h3 id=\"范例-6\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-6\" aria-label=\"范例 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-6\" aria-label=\"范例 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">\nclass Person {\n\tget name() { return this._name; }\n\tset name(arg) { this._name = arg; }\n\tget id() { return this._id; }\n\tset id(arg) { this._id = arg; }\n}\n\n\nconst martin = new Person();\nmartin.name = &quot;martin&quot;;\nmartin.id = &quot;1234&quot;;\n\n// 重构后\nclass Person {\n\tconstructor(id) {\n\t\tthis.id = id;\n\t}\n\tget name() { return this._name; }\n\tset name(arg) { this._name = arg; }\n\tget id() { return this._id; }\n\n}\n\n\nconst martin = new Person(&quot;1234&quot;);\nmartin.name = &quot;martin&quot;;</code>\n        </deckgo-highlight-code>\n<h2 id=\"以工厂函数取代构造函数replace-constructor-with-factory-function\" style=\"position:relative;\"><a href=\"#%E4%BB%A5%E5%B7%A5%E5%8E%82%E5%87%BD%E6%95%B0%E5%8F%96%E4%BB%A3%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0replace-constructor-with-factory-function\" aria-label=\"以工厂函数取代构造函数replace constructor with factory function permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E4%BB%A5%E5%B7%A5%E5%8E%82%E5%87%BD%E6%95%B0%E5%8F%96%E4%BB%A3%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0replace-constructor-with-factory-function\" aria-label=\"以工厂函数取代构造函数replace constructor with factory function permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>以工厂函数取代构造函数(Replace Constructor with Factory Function)</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">leadEngineer = new Employee(document.leadEngineer, &#39;E&#39;);\n\n\n\nleadEngineer = createEngineer(document.leadEngineer);</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-7\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-7\" aria-label=\"动机 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-7\" aria-label=\"动机 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<p>无法根据环境或参数信息返回子类实例或代理对象；构造函数的名字是固定的，因此无法使用默认名字更清晰的函数名；构造函数需要通过特殊的操作符来调用，所以在要求普通函数的场合就难以使用。工厂函数不受这些限制。</p>\n<h3 id=\"做法-7\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-7\" aria-label=\"做法 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-7\" aria-label=\"做法 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>创建一个工厂函数，让它调用现有的构造函数</li>\n<li>将调用构造函数的代码改为调用工厂函数</li>\n<li>每修改一处，就执行测试</li>\n<li>尽量缩小构造函数的可见范围</li>\n</ul>\n<h3 id=\"范例-7\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-7\" aria-label=\"范例 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-7\" aria-label=\"范例 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">\nclass Employee {\n\tconstructor(name, typeCode) {\n\t\tthis._name = name;\n\t\tthis._typeCode = typeCode;\n\t}\n\n\tget name() { return this._name; }\n\tget type() {\n\t\treturn Employee.legalTypeCodes[this._typeCode];\n\t}\n\tstatic get legalTypeCodes() {\n\t\treturn [&quot;E&quot;: &quot;Engineer&quot;, &quot;M&quot;: &quot;Manager&quot;, &quot;S&quot;: &quot;Salesman&quot;];\n\t}\n}\n\n// 调用方\ncandidate = new Employee(document.name, document.empType);\n\n// 重构第一步，创建工厂函数，把创建对象的责任之直接委托给构造函数\nfunction createEmployee(name, typeCode) {\n\treturn new Employee(name, typeCode);\n}\n\n\n// 调用方\ncandidate = createEmployee(document.name, document.empType);</code>\n        </deckgo-highlight-code>\n<h2 id=\"以命令取代函数replace-function-with-command\" style=\"position:relative;\"><a href=\"#%E4%BB%A5%E5%91%BD%E4%BB%A4%E5%8F%96%E4%BB%A3%E5%87%BD%E6%95%B0replace-function-with-command\" aria-label=\"以命令取代函数replace function with command permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E4%BB%A5%E5%91%BD%E4%BB%A4%E5%8F%96%E4%BB%A3%E5%87%BD%E6%95%B0replace-function-with-command\" aria-label=\"以命令取代函数replace function with command permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>以命令取代函数(Replace Function with Command)</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">function score(candidate, medicalExam, scoringGuide) {\n\tlet result = 0;\n\tlet healthLevel = 0;\n\t// long body code\n}\n\nclass Scorer {\n\tconstructor(candidate, medicalExam, scoringGuide) {\n\t\tthis._candidate = candidate;\n\t\tthis._medicalExam = medicalExam;\n\t\tthis._scoringGuide = scoringGuide;\n\t}\n\n\texecute() {\n\t\tthis._result = 0;\n\t\tthis._healthLevel = 0;\n\t\t// long body code\n\t}\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-8\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-8\" aria-label=\"动机 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-8\" aria-label=\"动机 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<p>将函数封装成自己的对象，有时也是一种有用的办法。这样的对象我称之为”命令对象“，或”命令“。\n这种对象大多只服务于单一函数。\n于普通函数相比，命令对象提供了更大的控制灵活性和更强的表达能力。除了函数调用本身，命令对象还可以支持附加的操作，例如撤销操作。</p>\n<h3 id=\"做法-8\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-8\" aria-label=\"做法 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-8\" aria-label=\"做法 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<ul>\n<li>为想要包装的函数创建一个空的类，更具该函数的名字为其命令</li>\n<li>使用搬移函数把函数移到空的类里</li>\n<li>可以考虑给每个参数创建一个字段，并在构造函数中添加对应的参数。</li>\n</ul>\n<h3 id=\"范例-8\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-8\" aria-label=\"范例 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-8\" aria-label=\"范例 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">// 每次搬移一个参数到构造函数\nfunction score(candidate, medicalExam, scoringGuide) {\n\treturn new Scorer(candidate).execute(medicalExam, scoringGuide);\n}\n\nclass Scorer {\n\tconstructor(candidate) {\n\t\tthis._candidate = candidate;\n\t}\n\n\texecute(medicalExam, scoringGuide) {\n\t\tlet result = 0;\n\t\tlet healthLevel = 0;\n\t\tlet highMedicalRiskFlag = false;\n\n\t\tif(medicalExam.isSmoker) {\n\t\t\thealthLevel += 10;\n\t\t\thighMedicalRiskFlag = true;\n\t\t}\n\n\t\tlet certificationGrade = &quot;regular&quot;;\n\t\tif(scoringGuide.stateWithLowCertification(this._candidate.originState)) {\n\t\t\tcertificationGrade = &quot;low&quot;;\n\t\t\tresult -=5;\n\t\t}\n\n\t\t// lots more code like this\n\t\tresult -= Math.max(healthLevel - 5, 0);\n\t\treturn result;\n\t}\n}\n\n// 继续处理其他参数\nfunction score(candidate, medicalExam, scoringGuide) {\n\treturn new Scorer(candidate, medicalExam, scoringGuide).execute();\n}\n\nclass Scorer {\n\tconstructor(candidate, medicalExam, scoringGuide) {\n\t\tthis._candidate = canndidate;\n\t\tthis._medicalExam = medicalExam;\n\t\tthis._scoringGuide = scoringGuide;\n\t}\n\n\texecute() {\n\t\tthis._result = 0;\n\t\tlet healthLevel = 0;\n\t\tlet highMedicalRiskFlag = false;\n\n\t\tif(this._medicalExam.isSmoker) {\n\t\t\thealthLevel += 10;\n\t\t\thighMedicalRiskFlag = true;\n\t\t}\n\n\t\tlet certificationGrade = &quot;regular&quot;;\n\t\tif(this._scoringGuide.stateWithLowCertification(this._candidate.originState)) {\n\t\t\tcertificationGrade = &quot;low&quot;;\n\t\t\tthis.result -=5;\n\t\t}\n\n\t\t// lots more code like this\n\t\tthis._result -= Math.max(healthLevel - 5, 0);\n\t\treturn this._result;\n\t}\n}\n\n// 接着提炼函数\n</code>\n        </deckgo-highlight-code>\n<h2 id=\"以函数取代命令replace-command-with-function\" style=\"position:relative;\"><a href=\"#%E4%BB%A5%E5%87%BD%E6%95%B0%E5%8F%96%E4%BB%A3%E5%91%BD%E4%BB%A4replace-command-with-function\" aria-label=\"以函数取代命令replace command with function permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E4%BB%A5%E5%87%BD%E6%95%B0%E5%8F%96%E4%BB%A3%E5%91%BD%E4%BB%A4replace-command-with-function\" aria-label=\"以函数取代命令replace command with function permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>以函数取代命令(Replace Command with Function)</h2>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">class ChargeCalculator {\n\tconstructor(customer, usage) {\n\t\tthis._customer = customer;\n\t\tthis._usage = usage;\n\t}\n\n\texecute() {\n\t\treturn this._customer.rate * this._usage;\n\t}\n}\n\n\nfunction charge(customer, usage) {\n\treturn customer.rate * usage;\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"动机-9\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%9C%BA-9\" aria-label=\"动机 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%8A%A8%E6%9C%BA-9\" aria-label=\"动机 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动机</h3>\n<p>函数不复杂时，有时候只想调用一个函数，</p>\n<h3 id=\"做法-9\" style=\"position:relative;\"><a href=\"#%E5%81%9A%E6%B3%95-9\" aria-label=\"做法 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E5%81%9A%E6%B3%95-9\" aria-label=\"做法 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>做法</h3>\n<h3 id=\"范例-9\" style=\"position:relative;\"><a href=\"#%E8%8C%83%E4%BE%8B-9\" aria-label=\"范例 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"#%E8%8C%83%E4%BE%8B-9\" aria-label=\"范例 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>范例</h3>\n<deckgo-highlight-code js  terminal=\"carbon\" theme=\"vscode\" line-numbers=\"true\" editable=\"true\"  highlight-lines=\"\">\n          <code slot=\"code\">class ChargeCalculator {\n\tconstructor(customer, usage) {\n\t\tthis._customer = customer;\n\t\tthis._usage = usage;\n\t}\n\n\tget baseCharge() {\n\t\treturn this._customer.baseRate * this._usage;\n\t}\n\n\tget charge() {\n\t\treturn this.baseCharge + this._provider.connectionCharge;\n\t}\n}\n\n\n// 调用\nmonthCharge = new ChargeCalculator(customer, usage, provider).charge;\n\n\n\n// 重构后\nfunction charge(customer, usage, provider) {\n\tconst baseCharge = customer.baseRate * usage;\n\treturn baseCharge + provider.connectionCharge;\n}</code>\n        </deckgo-highlight-code>"}}]}},"pageContext":{"dir":"/重构 改善既有代码的设计 第2版/i","filePath":"/重构 改善既有代码的设计 第2版/第11章 重构API/","name":"重构 改善既有代码的设计 第2版"}},"staticQueryHashes":["3159585216","3810076356"]}